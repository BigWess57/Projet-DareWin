<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:19,&quot;tests&quot;:78,&quot;passes&quot;:78,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-11-20T15:32:06.787Z&quot;,&quot;end&quot;:&quot;2025-11-20T15:32:08.175Z&quot;,&quot;duration&quot;:1388,&quot;testsRegistered&quot;:78,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;8e21828f-7d51-40d9-8fc9-380c14bd2898&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d54bab79-f746-4811-a396-dc625fb7f54f&quot;,&quot;title&quot;:&quot;tests Challenge contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;158e723f-d0a8-4f57-bfbf-10ca2c144393&quot;,&quot;title&quot;:&quot;deployment&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment \&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\n//Token deployment\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f4aec4d1-e70c-401f-8140-51286eced698&quot;,&quot;parentUUID&quot;:&quot;158e723f-d0a8-4f57-bfbf-10ca2c144393&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should juste deploy the contract&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, false, ethers.ZeroHash, \&quot;ipfsCid\&quot;)\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10ba555b-7c1f-4721-ad40-5525f5f01869&quot;,&quot;parentUUID&quot;:&quot;158e723f-d0a8-4f57-bfbf-10ca2c144393&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should juste deploy the contract in Group mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract in Group mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const playersAllowed = [\n    [signers[0].address],\n    [signers[1].address],\n    [signers[2].address],\n    [signers[3].address],\n    [signers[4].address]\n]\nmerkleTree = StandardMerkleTree.of(playersAllowed, [\&quot;address\&quot;]);\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\n//Challenge Deployment\nawait expect(\n    challenge = await Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, merkleTree.root, \&quot;ipfsCid\&quot;)\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3a5c35cf-ca05-49e4-a0de-4d186e1cf01e&quot;,&quot;parentUUID&quot;:&quot;158e723f-d0a8-4f57-bfbf-10ca2c144393&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;title&quot;:&quot;Constructor Validation Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Constructor Validation Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests \&quot;before each\&quot; hook in \&quot;Constructor Validation Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdaf51d9-0550-40cf-bdaf-9b5d07b8524e&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should revert with ZeroAddressToken when token address is zero&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with ZeroAddressToken when token address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        \&quot;0x0000000000000000000000000000000000000000\&quot;, // Invalid token\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;ZeroAddressToken\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0c8185e-7506-43ac-9483-7ac3d5ae8df5&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with ZeroAddressFeeReceiver when feeReceiver address is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with ZeroAddressFeeReceiver when feeReceiver address is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target, // Invalid token\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        \&quot;0x0000000000000000000000000000000000000000\&quot;,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;ZeroAddressFeeReceiver\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6255c74a-2a48-4c07-8d79-468faafce390&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidDuration when duration is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InvalidDuration when duration is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        0n, // Invalid duration\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InvalidDuration\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ccdb7d8b-81dc-4b5e-8939-7798b87789da&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers = 1 (&lt; 2) in LINK mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientPlayers when maxPlayers = 1 (&lt; 2) in LINK mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        1n, // Invalid: less than 2\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cc05fe2e-f9d3-4401-b269-a55ae45c860f&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers = 0 (&lt; 2) in LINK mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientPlayers when maxPlayers = 0 (&lt; 2) in LINK mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        0n, // Invalid: less than 2\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1bc6b683-d079-4d38-9c07-152d82c77b5b&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientBid when bid is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientBid when bid is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        maxPlayers,\n        0n, // Invalid bid\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientBid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2c232f46-eef6-4fb2-abd5-57e6a5baac21&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE: should revert with IPFSCidEmpty when IPFS CID is empty&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests GROUP MODE: should revert with IPFSCidEmpty when IPFS CID is empty&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const playersAllowed = [\n    [signers[0].address],\n    [signers[1].address]\n];\nconst merkleTree = StandardMerkleTree.of(playersAllowed, [\&quot;address\&quot;]);\n\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        true, // Group mode\n        merkleTree.root,\n        \&quot;\&quot; // Empty IPFS CID\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;IPFSCidEmpty\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;adee96e6-4a97-4d9b-af15-af9b6f0bccf4&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE : should revert with MerkleRootRequired if the merkle root is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests GROUP MODE : should revert with MerkleRootRequired if the merkle root is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, ethers.ZeroHash, \&quot;ipfsCid\&quot;)\n).to.be.revertedWithCustomError(Challenge, \&quot;MerkleRootRequired\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0a43aa1-4063-4838-ac14-56df0214bd53&quot;,&quot;parentUUID&quot;:&quot;6db48e7a-2e04-4fc7-9282-4f6ae820fc0c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e0c8185e-7506-43ac-9483-7ac3d5ae8df5&quot;,&quot;6255c74a-2a48-4c07-8d79-468faafce390&quot;,&quot;ccdb7d8b-81dc-4b5e-8939-7798b87789da&quot;,&quot;cc05fe2e-f9d3-4401-b269-a55ae45c860f&quot;,&quot;1bc6b683-d079-4d38-9c07-152d82c77b5b&quot;,&quot;2c232f46-eef6-4fb2-abd5-57e6a5baac21&quot;,&quot;adee96e6-4a97-4d9b-af15-af9b6f0bccf4&quot;,&quot;c0a43aa1-4063-4838-ac14-56df0214bd53&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:71,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[&quot;10ba555b-7c1f-4721-ad40-5525f5f01869&quot;,&quot;3a5c35cf-ca05-49e4-a0de-4d186e1cf01e&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:22,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;title&quot;:&quot;gathering players state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state \&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fe231dfd-7aba-4d7a-9d67-5dcbb4611fe1&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to join, and sends the money to the challenge contract correctly&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, and sends the money to the challenge contract correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v, r, s, deadline } = await GetRSVsig(signers[0], token, bid, challenge);\nexpect(\n    await token.balanceOf(challenge)\n).to.equal(0)\nawait expect(\n    challenge.joinChallenge(deadline, v, r, s, [])\n)\n.to.not.be.reverted;\n\nexpect(\n    await token.balanceOf(challenge)\n).to.equal(bid)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;024fd0cc-539a-4952-9d2f-a3aa9c2dea80&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join if the permit is wrong&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join if the permit is wrong&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v, r, s, deadline } = await GetRSVsig(signers[1], token, bid, challenge);\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline, v, r, s, [])\n)\n.to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientAllowance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;903ce9e7-3f0f-47cb-9be8-a0759d066017&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\nconst { v: v5, r: r5, s: s5, deadline: deadline5 } = await GetRSVsig(signers[4], token, bid, challenge);\nconst { v: v6, r: r6, s: s6, deadline: deadline6 } = await GetRSVsig(signers[5], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);  \nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, []);\nawait challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, []);\nawait challenge.connect(signers[4]).joinChallenge(deadline5, v5, r5, s5, []);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge(deadline6, v6, r6, s6, [])\n).to.be.revertedWithCustomError(challenge, \&quot;ChallengeFull\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;490755c2-6e44-40ce-9a26-4e712d1d474a&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a participant to join twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a participant to join twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(challenge.joinChallenge(deadline1, v1, r1, s1, [])).to.be.revertedWithCustomError(challenge, \&quot;AlreadyJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81272440-55b8-4744-8fc0-dd5ad2b0ad3e&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join even if his permit has been frontran (avoid DoS)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join even if his permit has been frontran (avoid DoS)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\n//Frontrun the permit call\nawait token.permit(signers[0].address, challenge, bid, deadline1, v1, r1, s1);\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline1, v1, r1, s1, [])\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef209b17-3811-4e83-ae6b-2439f535fc94&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues. Money should be sent back to him&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues. Money should be sent back to him&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:31,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//5 players join\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\nconst { v: v5, r: r5, s: s5, deadline: deadline5 } = await GetRSVsig(signers[4], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, []);\nawait challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, []);\nawait challenge.connect(signers[4]).joinChallenge(deadline5, v5, r5, s5, []);\n//one player withdraws from challenge\nexpect(\n    await token.balanceOf(signers[2].address)\n).to.equal(0);\nawait challenge.connect(signers[2]).withdrawFromChallenge();\n//His balance should be 1000\nexpect(\n    await token.balanceOf(signers[2].address)\n).to.equal(bid);\n//Admin successfully starts challenge\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5158d7c-b81c-4c76-bf65-e77fb4d24b95&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;NotJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c26bed4f-e64b-47aa-ad32-efc00ce73e03&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join, and then withdraw twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join, and then withdraw twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.withdrawFromChallenge();\n//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;NotJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad41eab1-49c1-4e5e-8c20-64bd5ca64df7&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join, withdraw and then join again the challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, withdraw and then join again the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Needed twice, because of the nonce\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\n\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.withdrawFromChallenge();\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n   challenge.joinChallenge(deadline2, v2, r2, s2, [])\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;be616311-4b6f-4278-81b7-f6d6a3db4178&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to start the challenge if there is less than 2 players&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow to start the challenge if there is less than 2 players&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InsufficientPlayersToStart\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a0800b8-5513-4877-9717-39539845b65c&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow the admin to go to the next state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow the admin to go to the next state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;be888960-250b-413d-9a6b-7aefbbf91d5f&quot;,&quot;parentUUID&quot;:&quot;500b5939-9336-432c-80b0-a8105d5ff0ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;024fd0cc-539a-4952-9d2f-a3aa9c2dea80&quot;,&quot;903ce9e7-3f0f-47cb-9be8-a0759d066017&quot;,&quot;490755c2-6e44-40ce-9a26-4e712d1d474a&quot;,&quot;81272440-55b8-4744-8fc0-dd5ad2b0ad3e&quot;,&quot;ef209b17-3811-4e83-ae6b-2439f535fc94&quot;,&quot;f5158d7c-b81c-4c76-bf65-e77fb4d24b95&quot;,&quot;c26bed4f-e64b-47aa-ad32-efc00ce73e03&quot;,&quot;ad41eab1-49c1-4e5e-8c20-64bd5ca64df7&quot;,&quot;be616311-4b6f-4278-81b7-f6d6a3db4178&quot;,&quot;6a0800b8-5513-4877-9717-39539845b65c&quot;,&quot;be888960-250b-413d-9a6b-7aefbbf91d5f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:151,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;389f2642-a66e-43e9-a8bd-a794150519dc&quot;,&quot;title&quot;:&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) \&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Deploying in group mode\n({challenge, signers, bid, token, merkleTree} = await loadFixture(groupModeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b51dd91e-9fab-444d-bc55-9f30ba169842&quot;,&quot;parentUUID&quot;:&quot;389f2642-a66e-43e9-a8bd-a794150519dc&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;FOR GROUP MODE : should still allow players to join&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should still allow players to join&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:21,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\n//Get merkle proof for each player\nconst proof1 = merkleTree.getProof([signers[0].address]);\nconst proof2 = merkleTree.getProof([signers[1].address]);\nconst proof3 = merkleTree.getProof([signers[2].address]);\nconst proof4 = merkleTree.getProof([signers[3].address]);\n//join with proof\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline1, v1, r1, s1, proof1)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, proof2)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, proof3)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, proof4)\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c02d1501-6f53-41e5-b188-da092cc6e412&quot;,&quot;parentUUID&quot;:&quot;389f2642-a66e-43e9-a8bd-a794150519dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[5], token, bid, challenge);\nconst proof1 = merkleTree.getProof([signers[0].address]);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge(deadline1, v1, r1, s1, proof1)\n).to.be.revertedWithCustomError(challenge, \&quot;NotWhitelisted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;47fc5467-8f16-4dbd-ad75-0bae52b1afba&quot;,&quot;parentUUID&quot;:&quot;389f2642-a66e-43e9-a8bd-a794150519dc&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c02d1501-6f53-41e5-b188-da092cc6e412&quot;,&quot;47fc5467-8f16-4dbd-ad75-0bae52b1afba&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:25,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;459e3fd6-fe4a-4f30-a640-6866146d7b7d&quot;,&quot;title&quot;:&quot;ongoing challenge state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state \&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f5e4b65-2422-4d6a-a8e0-3b045752bc52&quot;,&quot;parentUUID&quot;:&quot;459e3fd6-fe4a-4f30-a640-6866146d7b7d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;57da00f9-0f05-44e9-b017-d54bc9684202&quot;,&quot;parentUUID&quot;:&quot;459e3fd6-fe4a-4f30-a640-6866146d7b7d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;57da00f9-0f05-44e9-b017-d54bc9684202&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;title&quot;:&quot;voting for winner state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state \&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;52583eb7-c44a-4425-97bd-686b40ba7542&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to vote (for another player).&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow a player to vote (for another player).&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;10a5d600-02b4-4771-9be6-fc799debdd25&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a non player to vote&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a non player to vote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n   challenge.connect(signers[5]).voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;NotAPlayer\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;97b00925-2322-4066-9ebe-76d44bb26514&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to vote twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a player to vote twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nawait expect(\n   challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;AlreadyVoted\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5dee954e-8f8f-4d13-9536-ae212a765919&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidVoteTarget when voting for non-player&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should revert with InvalidVoteTarget when voting for non-player&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[5].address) // signer[5] never joined\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidVoteTarget\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;724305ce-67b7-412a-8074-ac733aeb1385&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidVoteTarget when voting for zero address&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should revert with InvalidVoteTarget when voting for zero address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(ethers.ZeroAddress)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidVoteTarget\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc017087-5ec5-4963-806d-7acdd4d0fc2d&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait expect(\n   challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;VotingStillOngoing\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1010d259-9d3d-4c46-80e1-38235073b7af&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\n//Pass enough time\nawait time.increase(votingDelay);\nawait expect(\n   challenge.connect(signers[2]).endWinnerVote()\n).not.to.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;df233d41-6e5a-4e03-93a5-4b3ed55fdf69&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Any player can end vote, because everyone has voted\nawait challenge.connect(signers[1]).endWinnerVote();\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.ChallengeWon);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f2419326-9111-420d-950d-70a9ef67c149&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Pass enough time\n            await time.increase(votingDelay);\n            //Any player can end vote, because everyone has voted\n            await expect(challenge.connect(signers[1]).endWinnerVote()).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de8d6e1d-9b78-4912-af7f-bc481d01644f&quot;,&quot;parentUUID&quot;:&quot;da10092f-402c-4213-86b0-08011732c702&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;10a5d600-02b4-4771-9be6-fc799debdd25&quot;,&quot;97b00925-2322-4066-9ebe-76d44bb26514&quot;,&quot;5dee954e-8f8f-4d13-9536-ae212a765919&quot;,&quot;724305ce-67b7-412a-8074-ac733aeb1385&quot;,&quot;fc017087-5ec5-4963-806d-7acdd4d0fc2d&quot;,&quot;1010d259-9d3d-4c46-80e1-38235073b7af&quot;,&quot;df233d41-6e5a-4e03-93a5-4b3ed55fdf69&quot;,&quot;f2419326-9111-420d-950d-70a9ef67c149&quot;,&quot;de8d6e1d-9b78-4912-af7f-bc481d01644f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:40,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;title&quot;:&quot;challenge won state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state \&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ae46b3b8-24fd-465f-88a2-2d3c120a9fcf&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;winner should be able to retrieve prize when endWinnerVote() is triggered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should be able to retrieve prize when endWinnerVote() is triggered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[2].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*bronze/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;53fd9c5f-402f-4010-a3dc-072d2323fd76&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with NotAWinner when non-winner tries to withdraw&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state should revert with NotAWinner when non-winner tries to withdraw&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// signers[2] has 2 votes, signers[1] has 3 votes (winner)\n// signers[0] has 0 votes, signers[3] has 0 votes, signers[4] has 0 votes\n//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait expect(\n    challenge.connect(signers[0]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;NotAWinner\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abadeae5-a010-423e-ab22-42be12c2a58f&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with NotAWinner when player with votes (but not highest) tries to withdraw&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state should revert with NotAWinner when player with votes (but not highest) tries to withdraw&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// In EndingVoteFixture, signers[2] has 2 votes but signers[1] has 3 (highest)\n//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait expect(\n    challenge.connect(signers[1]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;NotAWinner\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e7017e6-b0d2-433d-9da7-502b02286126&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;winner should NOT be able to retrieve prize multiple times&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should NOT be able to retrieve prize multiple times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\nawait expect(\n    challenge.connect(signers[2]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;PrizeAlreadyWithdrawn\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db53466a-a60b-4740-a5ef-864b6d67dd59&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;When there is a tie, should allow both winners to receive prize&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state When there is a tie, should allow both winners to receive prize&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:17,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[3].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[3].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\n//Check balance before for both winners\nconst balanceBefore1 = await token.balanceOf(signers[1].address);\nconst balanceBefore2 = await token.balanceOf(signers[3].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[1]).withdrawPrize();\n//Check balance after (winner1)\nconst balanceAfter1 = await token.balanceOf(signers[1].address);\nconst diff1 = balanceAfter1 - balanceBefore1;\nconst expectedDiff1 = bid*5n/2n - bid*5n/2n*gold/100n;\nexpect(\n    diff1\n).to.equal(expectedDiff1);\nawait challenge.connect(signers[3]).withdrawPrize();\n//Check balance after (winner2)\nconst balanceAfter2 = await token.balanceOf(signers[3].address);\nconst diff2 = balanceAfter2 - balanceBefore2;\nconst expectedDiff2 = bid*5n/2n - bid*5n/2n*silver/100n;\nexpect(\n    diff2\n).to.equal(expectedDiff2); //substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f679cd9c-4f08-4fc4-8a9d-79413ca62c82&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;if more tokens (signers[1] gold tier here), winner should receive more tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state if more tokens (signers[1] gold tier here), winner should receive more tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[0].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[1].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[1]).withdrawPrize();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[1].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*gold/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1abd3f19-1a38-4800-a55e-1b3202d883f2&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst balanceBefore = await token.balanceOf(signers[0].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\nconst balanceAfter = await token.balanceOf(signers[0].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedFeesReceived = 5n*bid/2n*bronze/100n;\n\nexpect(\n    diff\n).to.equal(expectedFeesReceived);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8d07a4a3-0945-4974-b6f6-3f89ac1c1972&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;half of the fees should have been burnt&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state half of the fees should have been burnt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:13,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[0].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[0].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst initialTotalSupply = await token.totalSupply();\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[0]).withdrawPrize();\nconst finalTotalSupply = await token.totalSupply();\nconst diff = initialTotalSupply - finalTotalSupply;\nconst expectedBurntAmount = bid*5n/2n*platinum/100n;\n\nexpect(\n    diff\n).to.equal(expectedBurntAmount);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0aa40a4f-8a33-4568-9904-3b58d6216eff&quot;,&quot;parentUUID&quot;:&quot;a3bf9256-d451-4857-89b9-9f0fb114da20&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;53fd9c5f-402f-4010-a3dc-072d2323fd76&quot;,&quot;abadeae5-a010-423e-ab22-42be12c2a58f&quot;,&quot;5e7017e6-b0d2-433d-9da7-502b02286126&quot;,&quot;db53466a-a60b-4740-a5ef-864b6d67dd59&quot;,&quot;f679cd9c-4f08-4fc4-8a9d-79413ca62c82&quot;,&quot;1abd3f19-1a38-4800-a55e-1b3202d883f2&quot;,&quot;8d07a4a3-0945-4974-b6f6-3f89ac1c1972&quot;,&quot;0aa40a4f-8a33-4568-9904-3b58d6216eff&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:105,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;68f558b0-d38b-431b-85b4-62e256e92b46&quot;,&quot;title&quot;:&quot;Owner functions&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow not admin player to go to OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Owner functions should not allow not admin player to go to OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase);\nawait expect(\n   challenge.connect(signers[1]).startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;OwnableUnauthorizedAccount\&quot;).withArgs(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;478c4a5c-b540-4309-9005-575f5e9fb6aa&quot;,&quot;parentUUID&quot;:&quot;68f558b0-d38b-431b-85b4-62e256e92b46&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;478c4a5c-b540-4309-9005-575f5e9fb6aa&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;c11b5607-0b6b-4c8f-8219-22d8607d6da5&quot;,&quot;title&quot;:&quot;State functions availability&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;deaef0c6-ea55-49b9-8db1-311ffe846231&quot;,&quot;title&quot;:&quot;state GatheringPlayers&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers \&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d05a7850-51e5-45f8-8acd-a1fe221ed58b&quot;,&quot;parentUUID&quot;:&quot;deaef0c6-ea55-49b9-8db1-311ffe846231&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1f5bbf69-a868-4f18-a9e0-484fcec5ce32&quot;,&quot;parentUUID&quot;:&quot;deaef0c6-ea55-49b9-8db1-311ffe846231&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd466c98-da34-4803-bbae-3f4ad5c59f9c&quot;,&quot;parentUUID&quot;:&quot;deaef0c6-ea55-49b9-8db1-311ffe846231&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow withdrawPrize() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3798ee9b-0e87-43a6-9d79-777480d60349&quot;,&quot;parentUUID&quot;:&quot;deaef0c6-ea55-49b9-8db1-311ffe846231&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1f5bbf69-a868-4f18-a9e0-484fcec5ce32&quot;,&quot;dd466c98-da34-4803-bbae-3f4ad5c59f9c&quot;,&quot;3798ee9b-0e87-43a6-9d79-777480d60349&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:7,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;title&quot;:&quot;state OngoingChallenge&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge \&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e5243d39-cb59-4dd1-bc75-0fde6873ba70&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dabdd279-39a2-4fae-ac10-0e13cae83639&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b9ada7dc-1499-4d9d-9207-5a23a3abc185&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow startChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dca37a00-06d7-4fe1-bc30-851d4d689d1c&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;VotingNotAllowed\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2bc7cdaa-7c12-4c36-b748-d1d243c1d447&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);\n//wait for challenge to end\nawait time.increase(duration);\n\n//should be allowed\nawait expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;\n//State should have changed\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.VotingForWinner);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cbb29fc6-62f6-4edd-b0f4-e84f5362a6c9&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0b98007-0571-4520-969d-9a521dc27b36&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in OnGoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawPrize() in OnGoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b0528b6b-e2cc-41f4-a23d-8d092881c3d4&quot;,&quot;parentUUID&quot;:&quot;a30f3af6-2308-4c8d-853c-a182cd93aa7c&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;dabdd279-39a2-4fae-ac10-0e13cae83639&quot;,&quot;b9ada7dc-1499-4d9d-9207-5a23a3abc185&quot;,&quot;dca37a00-06d7-4fe1-bc30-851d4d689d1c&quot;,&quot;2bc7cdaa-7c12-4c36-b748-d1d243c1d447&quot;,&quot;cbb29fc6-62f6-4edd-b0f4-e84f5362a6c9&quot;,&quot;c0b98007-0571-4520-969d-9a521dc27b36&quot;,&quot;b0528b6b-e2cc-41f4-a23d-8d092881c3d4&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:16,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;title&quot;:&quot;state VotingForWinner&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner \&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2613eafe-72e4-4a01-9a9d-fed6147b9831&quot;,&quot;parentUUID&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow joinChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;196d3ef9-1b33-4945-80ea-f17cd3e0653f&quot;,&quot;parentUUID&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3daed32-889e-4683-98b0-90c7a92e6a46&quot;,&quot;parentUUID&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow startChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c61c9e89-bbe4-4578-826a-ec6dd02e3f36&quot;,&quot;parentUUID&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawPrize() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d28e0346-030d-45e2-8df9-20fc39388b80&quot;,&quot;parentUUID&quot;:&quot;b666a3d0-5e77-4b59-97be-8f333a573f0e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;196d3ef9-1b33-4945-80ea-f17cd3e0653f&quot;,&quot;d3daed32-889e-4683-98b0-90c7a92e6a46&quot;,&quot;c61c9e89-bbe4-4578-826a-ec6dd02e3f36&quot;,&quot;d28e0346-030d-45e2-8df9-20fc39388b80&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;title&quot;:&quot;state ChallengeWon&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon \&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(EndingVoteFixture));\nawait challenge.endWinnerVote();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a0248a3e-88c0-41e5-912f-65e79dbc0d69&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow joinChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3086e0c-0367-4350-9514-295a43bbf190&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;99691b42-66f0-4663-8a8b-3db07be45ecf&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow startChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b3dfe3b-6f32-41d0-be35-2cf46e9f1e60&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow voteForWinner() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6b9c8e13-56cb-4583-9adb-20183a12b3b9&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;17415906-44b3-4cd6-b7d2-c33d9a03ba4f&quot;,&quot;parentUUID&quot;:&quot;91875761-2a78-43d4-aa56-69e3680806dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e3086e0c-0367-4350-9514-295a43bbf190&quot;,&quot;99691b42-66f0-4663-8a8b-3db07be45ecf&quot;,&quot;0b3dfe3b-6f32-41d0-be35-2cf46e9f1e60&quot;,&quot;6b9c8e13-56cb-4583-9adb-20183a12b3b9&quot;,&quot;17415906-44b3-4cd6-b7d2-c33d9a03ba4f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:14,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;title&quot;:&quot;Events&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should emit an event when a Player Joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(challenge.joinChallenge(deadline1, v1, r1, s1, []))\n    .to.emit(challenge, \&quot;PlayerJoined\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;85cd0cf0-1fad-491d-bfb5-c02e447bed8f&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a Player Withdraws from challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Withdraws from challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(challenge.withdrawFromChallenge())\n    .to.emit(challenge, \&quot;PlayerWithdrawn\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;35a2ea3f-5409-4165-b420-1b20886e0056&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeStarted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeStarted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait expect(challenge.startChallenge())\n    .to.emit(challenge, \&quot;ChallengeStarted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9fbdb7f0-e571-45c5-a580-dda7be757757&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeEnded &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeEnded &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:54,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(OngoingChallengeFixture)\n//Pass enough time\nawait time.increase(duration)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;ChallengeEnded\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cdb1e115-884e-4336-af3f-209cfdc1d870&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when PlayerVoted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when PlayerVoted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:57,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(VotingForWinnerFixture)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;PlayerVoted\&quot;)\n    .withArgs(signers[0].address, signers[1].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d5a9d5c-664f-473f-8b49-663bcb17e28e&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a prize is sent&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a prize is sent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:80,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;slow&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(EndingVoteFixture)\nawait challenge.endWinnerVote()\nconst expectedPrize = bid*5n - 5n*bid*BigInt(gold)/100n;\nawait expect(\n    await challenge.connect(signers[1]).withdrawPrize()\n).to.emit(challenge, \&quot;PrizeWithdrawn\&quot;)\n    .withArgs(signers[1].address, expectedPrize)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ad00c12b-61fe-4449-aaf0-7185ee3b97a8&quot;,&quot;parentUUID&quot;:&quot;fba8b3d7-bfab-49ca-ae53-b6e4d850e9ea&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;85cd0cf0-1fad-491d-bfb5-c02e447bed8f&quot;,&quot;35a2ea3f-5409-4165-b420-1b20886e0056&quot;,&quot;9fbdb7f0-e571-45c5-a580-dda7be757757&quot;,&quot;cdb1e115-884e-4336-af3f-209cfdc1d870&quot;,&quot;7d5a9d5c-664f-473f-8b49-663bcb17e28e&quot;,&quot;ad00c12b-61fe-4449-aaf0-7185ee3b97a8&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:218,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a3539e7c-52d0-41b9-955c-6b92ccf409d9&quot;,&quot;title&quot;:&quot;tests ChallengeFactory contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;title&quot;:&quot;First tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;First tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests \&quot;before each\&quot; hook in \&quot;First tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, ethers.ZeroHash, \&quot;ipfsCid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0266ae3-88ec-4126-964d-3d528b31c36b&quot;,&quot;parentUUID&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should just deploy the challenge factory, and create a challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should just deploy the challenge factory, and create a challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef71b819-dde2-4ee6-bc13-19147155acc6&quot;,&quot;parentUUID&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event on new challenge deployment&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should emit an event on new challenge deployment&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filter = challengeFactory.filters.ChallengeCreated(signers[0].address);\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            expect(event.fragment.name).to.equal(&#x27;ChallengeCreated&#x27;)\n            const args = event.args\n            expect(args.admin).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b6bfa53-880e-447b-b8b6-be34b00f36e6&quot;,&quot;parentUUID&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow to deploy a new challenge contract&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should allow to deploy a new challenge contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n            const filter = challengeFactory.filters.ChallengeCreated;\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            const newContractAddress = event.args.challengeAddress;\n            // 3. Attach to the deployed challenge\n            const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n            const challenge = Challenge.attach(newContractAddress);\n            // Verify initialisation\n            const _duration = await challenge.duration();\n            const _maxPlayers = await challenge.maxPlayers();\n            const _bid = await challenge.bid();\n            const _description = await challenge.description();\n            expect(_duration).to.equal(1000n);\n            expect(_maxPlayers).to.equal(5n);\n            expect(_bid).to.equal(bid);\n            expect(_description).to.equal(\&quot;test\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;694ea9e1-193b-4b0f-835c-553fbdb28301&quot;,&quot;parentUUID&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n            const filter = challengeFactory.filters.ChallengeCreated;\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            const newContractAddress = event.args.challengeAddress;\n            // 3. Attach to the deployed challenge\n            const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n            const challenge = Challenge.attach(newContractAddress);\n            const owner = await challenge.owner()\n            expect(owner).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;37c82df8-d28a-4d1b-8e60-dbcc7431156d&quot;,&quot;parentUUID&quot;:&quot;ac876273-be69-40c5-b1d3-45ad57569b36&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ef71b819-dde2-4ee6-bc13-19147155acc6&quot;,&quot;2b6bfa53-880e-447b-b8b6-be34b00f36e6&quot;,&quot;694ea9e1-193b-4b0f-835c-553fbdb28301&quot;,&quot;37c82df8-d28a-4d1b-8e60-dbcc7431156d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:17,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;title&quot;:&quot;Parameter Validation Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Parameter Validation Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests \&quot;before each\&quot; hook in \&quot;Parameter Validation Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6a38c5b2-8b6e-4361-a452-a4d1ca3ffac7&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should revert with ZeroAddressToken when token address is zero&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with ZeroAddressToken when token address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(\&quot;0x0000000000000000000000000000000000000000\&quot;, signers[0].address)\n).to.be.revertedWithCustomError(ChallengeFactory, \&quot;ZeroAddressToken\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78adf913-f165-4950-9a84-b75a95db4d68&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with ZeroAddressFeeReceiver when feeReceiver address is zero&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with ZeroAddressFeeReceiver when feeReceiver address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(token.target, \&quot;0x0000000000000000000000000000000000000000\&quot;)\n).to.be.revertedWithCustomError( ChallengeFactory, \&quot;ZeroAddressFeeReceiver\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;031032ad-e65e-4491-a091-2862d50eb9fc&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidDuration when duration is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InvalidDuration when duration is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        0n, // Invalid duration\n        maxPlayers,\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InvalidDuration\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98cc8570-4166-4f70-bee6-192914911364&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers is less than 2&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientPlayers when maxPlayers is less than 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        1n, // Invalid: less than 2\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;094f735c-365a-485a-95e6-4de26189b7fe&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientPlayers when maxPlayers is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        0n, // Invalid: 0 players\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;81a9314b-d47a-4893-9dab-7090c2fcc4bf&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientBid when bid is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientBid when bid is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        maxPlayers,\n        0n, // Invalid bid\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientBid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;045e7572-d347-421d-8617-e6c80d9bf9ad&quot;,&quot;parentUUID&quot;:&quot;3471d3cf-6e49-4b83-95d0-c0361fb4fe4f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;78adf913-f165-4950-9a84-b75a95db4d68&quot;,&quot;031032ad-e65e-4491-a091-2862d50eb9fc&quot;,&quot;98cc8570-4166-4f70-bee6-192914911364&quot;,&quot;094f735c-365a-485a-95e6-4de26189b7fe&quot;,&quot;81a9314b-d47a-4893-9dab-7090c2fcc4bf&quot;,&quot;045e7572-d347-421d-8617-e6c80d9bf9ad&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:21,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;d6b24afc-8275-439a-a6e1-7fcdfab00004&quot;,&quot;title&quot;:&quot;Group Mode Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Group Mode Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Group Mode Tests \&quot;before each\&quot; hook in \&quot;Group Mode Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dad600aa-c62d-40ba-ac6e-f1d9f686a038&quot;,&quot;parentUUID&quot;:&quot;d6b24afc-8275-439a-a6e1-7fcdfab00004&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create challenge with groupMode false and zero merkle root&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Group Mode Tests should create challenge with groupMode false and zero merkle root&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        false, // groupMode = false\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.emit(challengeFactory, &#x27;ChallengeCreated&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c06d715a-8f40-42c4-a792-2fd9915f2c06&quot;,&quot;parentUUID&quot;:&quot;d6b24afc-8275-439a-a6e1-7fcdfab00004&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c06d715a-8f40-42c4-a792-2fd9915f2c06&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:40000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportFilename&quot;:&quot;report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;report&quot;,&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-report/assets&quot;,&quot;jsonFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.json&quot;,&quot;htmlFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>