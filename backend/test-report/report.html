<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:15,&quot;tests&quot;:58,&quot;passes&quot;:58,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-09-02T17:55:51.012Z&quot;,&quot;end&quot;:&quot;2025-09-02T17:55:51.812Z&quot;,&quot;duration&quot;:800,&quot;testsRegistered&quot;:58,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;5ad9d17e-7f7f-47c3-a50d-6f1129223837&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;f7827b19-d91e-45ec-be70-94bffb86a875&quot;,&quot;title&quot;:&quot;tests Challenge contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;109e56b9-5f95-4ee6-ab82-6e4e161ef0bb&quot;,&quot;title&quot;:&quot;deployment&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment \&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\n//Token deployment\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c7c3f7eb-a681-4e22-b3e1-73500233793e&quot;,&quot;parentUUID&quot;:&quot;109e56b9-5f95-4ee6-ab82-6e4e161ef0bb&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should juste deploy the contract&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, false, [])\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3951144e-95c1-451b-9442-0079022ece86&quot;,&quot;parentUUID&quot;:&quot;109e56b9-5f95-4ee6-ab82-6e4e161ef0bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, \&quot;0x0000000000000000000000000000000000000000\&quot;, false, [])\n).to.be.revertedWith(\&quot;the feeReceiver cannot be address 0!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c80a1054-3a3d-46c1-8859-72fb338e9cea&quot;,&quot;parentUUID&quot;:&quot;109e56b9-5f95-4ee6-ab82-6e4e161ef0bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE : should not be possible to deploy if one player in the array is address 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment GROUP MODE : should not be possible to deploy if one player in the array is address 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nconst playersArray = [signers[0].address, signers[1].address, \&quot;0x0000000000000000000000000000000000000000\&quot;]\nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, playersArray)\n).to.be.revertedWith(\&quot;address 0 cannot be a player!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0be03c6f-040d-4eb5-bd5c-1b36d45c7e26&quot;,&quot;parentUUID&quot;:&quot;109e56b9-5f95-4ee6-ab82-6e4e161ef0bb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3951144e-95c1-451b-9442-0079022ece86&quot;,&quot;c80a1054-3a3d-46c1-8859-72fb338e9cea&quot;,&quot;0be03c6f-040d-4eb5-bd5c-1b36d45c7e26&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:26,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;title&quot;:&quot;gathering players state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state \&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e56d256-9129-48f8-bf2f-9b72f77f4bc9&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should store a player in the players array (sending enough money)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should store a player in the players array (sending enough money)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(challenge.joinChallenge())\n           .to.not.be.reverted;\n           await expect(challenge.connect(signers[1]).joinChallenge())\n           .to.not.be.reverted;\n           const player1 = await challenge.players(0);\n           expect(player1[0]).to.equal(signers[0].address);\n           const player2 = await challenge.players(1);\n           expect(player2[0]).to.equal(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;53fffd76-e774-487f-83bd-a581f4e09c02&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:18,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.connect(signers[2]).joinChallenge();\nawait challenge.connect(signers[3]).joinChallenge();\nawait challenge.connect(signers[4]).joinChallenge();\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[2].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);\nconst player5 = await challenge.players(4);\nexpect(player5[0]).to.equal(signers[4].address);\nawait expect(challenge.connect(signers[5]).joinChallenge()).to.be.revertedWith(\&quot;This challenge is already full\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;93258353-d1aa-4217-be4e-36e43ef89e06&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a participant to join twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a participant to join twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait expect(challenge.joinChallenge()).to.be.revertedWith(\&quot;You already joined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4d9d0b32-5720-415d-a734-ad8b9ef10712&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join if he did not approve enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join if he did not approve enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//signer 5 approves not enough tokens\nawait token.connect(signers[5]).approve(challenge.target, bid-1n);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge()\n).to.be.revertedWith(\&quot;Need prior approval for token spending\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fda5011e-904e-456c-87ab-19744c2c252c&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//5 players join\nawait challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.connect(signers[2]).joinChallenge();\nawait challenge.connect(signers[3]).joinChallenge();\nawait challenge.connect(signers[4]).joinChallenge();\n//one player withdraws from challenge\nawait challenge.connect(signers[2]).withdrawFromChallenge();\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[4].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);\n//the 3rd player should not be in the array anymore, this should revert\nawait expect(\n    challenge.players(4)\n).to.be.reverted;\n//Admin successfully starts challenge\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;893aae77-991c-45e2-9df5-dca04d0e58aa&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;You are not in players list\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f6406778-e9b0-445f-b1bf-9bb1f7c5e8c7&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join, withdraw and then join again the challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, withdraw and then join again the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.withdrawFromChallenge();\nawait expect(\n   challenge.joinChallenge()\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da6abaa2-f418-44c3-8cdf-07f45e48ff3f&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to start the challenge if there is less than 2 players&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow to start the challenge if there is less than 2 players&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;challenge.joinChallenge();\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not enough players to start the challenge\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;49a43a9c-35d9-47e1-963a-6667ffdeb106&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert startChallenge() if a participant doesnt have enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should revert startChallenge() if a participant doesnt have enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge()\n//signer 0 sends tokens to signer 6, but not enough\nawait token.transfer(signers[6], bid-1n);\nawait token.connect(signers[6]).approve(challenge.target, bid);\nawait challenge.connect(signers[6]).joinChallenge()\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientBalance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4ff15e30-bd5f-4f69-a650-559ec49be9ab&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert startChallenge() if a participant did not approve enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should revert startChallenge() if a participant did not approve enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge()\n//signer 0 sends tokens to signer 6, but not enough\nawait token.transfer(signers[6], bid);\nawait token.connect(signers[6]).approve(challenge.target, bid);\nawait challenge.connect(signers[6]).joinChallenge()\n//lowers approval amount\nawait token.connect(signers[6]).approve(challenge.target, bid-1n);\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientAllowance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5d3d64f-eff0-421b-82f8-f8e5b3302b21&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow the admin to go to the next state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow the admin to go to the next state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;73a08d29-5047-434c-a36d-137aa39eb937&quot;,&quot;parentUUID&quot;:&quot;b7ec7a8c-d287-4712-bed2-8e6a0ec4d1f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;53fffd76-e774-487f-83bd-a581f4e09c02&quot;,&quot;93258353-d1aa-4217-be4e-36e43ef89e06&quot;,&quot;4d9d0b32-5720-415d-a734-ad8b9ef10712&quot;,&quot;fda5011e-904e-456c-87ab-19744c2c252c&quot;,&quot;893aae77-991c-45e2-9df5-dca04d0e58aa&quot;,&quot;f6406778-e9b0-445f-b1bf-9bb1f7c5e8c7&quot;,&quot;da6abaa2-f418-44c3-8cdf-07f45e48ff3f&quot;,&quot;49a43a9c-35d9-47e1-963a-6667ffdeb106&quot;,&quot;4ff15e30-bd5f-4f69-a650-559ec49be9ab&quot;,&quot;f5d3d64f-eff0-421b-82f8-f8e5b3302b21&quot;,&quot;73a08d29-5047-434c-a36d-137aa39eb937&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:80,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;7fd652d4-c1a5-43d3-9429-b37c50cf4479&quot;,&quot;title&quot;:&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) \&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Deploying in group mode\n({challenge, signers, bid, token} = await loadFixture(groupModeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;31b3e90d-0a6a-4123-89a6-70060de21316&quot;,&quot;parentUUID&quot;:&quot;7fd652d4-c1a5-43d3-9429-b37c50cf4479&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;FOR GROUP MODE : the stored array of players should be correct&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : the stored array of players should be correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.connect(signers[0]).joinChallenge()\nawait challenge.connect(signers[1]).joinChallenge()\nawait challenge.connect(signers[2]).joinChallenge()\nawait challenge.connect(signers[3]).joinChallenge()\n\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[2].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e2715956-bfd7-45cb-a3f0-60d760197298&quot;,&quot;parentUUID&quot;:&quot;7fd652d4-c1a5-43d3-9429-b37c50cf4479&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.connect(signers[5]).joinChallenge()\n).to.be.revertedWith(\&quot;You are not allowed to join this challenge.\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7579859b-ff34-4bae-887f-ced902ba10be&quot;,&quot;parentUUID&quot;:&quot;7fd652d4-c1a5-43d3-9429-b37c50cf4479&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e2715956-bfd7-45cb-a3f0-60d760197298&quot;,&quot;7579859b-ff34-4bae-887f-ced902ba10be&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;df7c097d-79c9-42af-8a6e-c0b0970e69be&quot;,&quot;title&quot;:&quot;ongoing challenge state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state \&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dc1a4cd4-15a4-4d38-8869-c7d41789b870&quot;,&quot;parentUUID&quot;:&quot;df7c097d-79c9-42af-8a6e-c0b0970e69be&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0fc7fde9-d26b-4e17-a64a-6c0da3af9a08&quot;,&quot;parentUUID&quot;:&quot;df7c097d-79c9-42af-8a6e-c0b0970e69be&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;0fc7fde9-d26b-4e17-a64a-6c0da3af9a08&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;title&quot;:&quot;voting for winner state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state \&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1e77f09b-6cb2-4af0-b834-2c41498ccdef&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to vote (for another player). check that the vote is registered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow a player to vote (for another player). check that the vote is registered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nconst player2 = await challenge.players(1);\nexpect(player2[1]).to.equal(1);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b41b06fc-ef7b-4d21-b993-fee024a7abda&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a non player to vote&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a non player to vote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n   challenge.connect(signers[5]).voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You are not a player. You cannot vote for winner.\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a95817e-6784-4608-8574-fbef21cad7c5&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to vote twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a player to vote twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nawait expect(\n   challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You have already voted.\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;062fa6af-58ef-4a55-8bfe-ae5bc3dda82e&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait expect(\n   challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not all player have voted for a winner yet (and minimum delay has not passed)\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;220c89d9-a18b-4bea-a279-7423902b8f3d&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\n//Pass enough time\nawait time.increase(votingDelay);\nawait expect(\n   challenge.connect(signers[2]).endWinnerVote()\n).not.to.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;89de180f-dda3-4971-9278-10097f54cf3c&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Any player can end vote, because everyone has voted\nawait challenge.connect(signers[1]).endWinnerVote();\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.ChallengeWon);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c87608d2-f910-4b4c-a582-395368dff400&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Pass enough time\n            await time.increase(votingDelay);\n            //Any player can end vote, because everyone has voted\n            await expect(challenge.connect(signers[1]).endWinnerVote()).to.be.revertedWith(&#x27;Not allowed in this state&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bdede169-6bc7-4e8e-a670-7fb76d9d304a&quot;,&quot;parentUUID&quot;:&quot;aadd268d-545c-4f17-b00f-d07ced5cd857&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;b41b06fc-ef7b-4d21-b993-fee024a7abda&quot;,&quot;7a95817e-6784-4608-8574-fbef21cad7c5&quot;,&quot;062fa6af-58ef-4a55-8bfe-ae5bc3dda82e&quot;,&quot;220c89d9-a18b-4bea-a279-7423902b8f3d&quot;,&quot;89de180f-dda3-4971-9278-10097f54cf3c&quot;,&quot;c87608d2-f910-4b4c-a582-395368dff400&quot;,&quot;bdede169-6bc7-4e8e-a670-7fb76d9d304a&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:31,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;title&quot;:&quot;challenge won state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state \&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1b3b9a4-e9fa-44ec-b430-437fe998eff7&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;winner should receive prize when endWinnerVote() is triggered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should receive prize when endWinnerVote() is triggered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[2].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*bronze/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1b78eab8-12a0-47ee-a7c0-7fd6bde96fb8&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;if more tokens (signers[1] gold tier here) winner should receive more tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state if more tokens (signers[1] gold tier here) winner should receive more tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[0].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[1].address);\n//End vote\nawait challenge.endWinnerVote();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[1].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*gold/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;58975f72-8ce2-4a0d-ad12-20300b771747&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst balanceBefore = await token.balanceOf(signers[0].address);\n//End vote\nawait challenge.endWinnerVote();\nconst balanceAfter = await token.balanceOf(signers[0].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedFeesReceived = 5n*bid/2n*bronze/100n;\n\nexpect(\n    diff\n).to.equal(expectedFeesReceived);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f3b1b578-3823-4a01-9f97-a4102bcb977d&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;half of the fees should have been burnt&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state half of the fees should have been burnt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[0].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[0].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst initialTotalSupply = await token.totalSupply();\n//End vote\nawait challenge.endWinnerVote();\nconst finalTotalSupply = await token.totalSupply();\nconst diff = initialTotalSupply - finalTotalSupply;\nconst expectedBurntAmount = bid*5n/2n*platinum/100n;\n\nexpect(\n    diff\n).to.equal(expectedBurntAmount);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dddf4536-332e-45bc-91c2-42b229500fa7&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;When there is a tie, should allow both winners to receive prize&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state When there is a tie, should allow both winners to receive prize&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:14,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\n//Check balance before for both winners\nconst balanceBefore1 = await token.balanceOf(signers[1].address);\nconst balanceBefore2 = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\nconst winner1 = await challenge.challengeWinners(0)\nconst winner2 = await challenge.challengeWinners(1)\nexpect(winner1).to.equal(signers[2].address);\nexpect(winner2).to.equal(signers[1].address);\n//Check balance after (winner1)\nconst balanceAfter1 = await token.balanceOf(signers[1].address);\nconst diff1 = balanceAfter1 - balanceBefore1;\nconst expectedDiff1 = bid*5n/2n - bid*5n/2n*gold/100n;\nexpect(\n    diff1\n).to.equal(expectedDiff1);\n//Check balance after (winner2)\nconst balanceAfter2 = await token.balanceOf(signers[2].address);\nconst diff2 = balanceAfter2 - balanceBefore2;\nconst expectedDiff2 = bid*5n/2n - bid*5n/2n*bronze/100n;\nexpect(\n    diff2\n).to.equal(expectedDiff2); //substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9614d561-819c-45b2-8fa9-4b64e0b5f763&quot;,&quot;parentUUID&quot;:&quot;d54ac17a-c791-47d3-a211-ca6e8437d390&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1b78eab8-12a0-47ee-a7c0-7fd6bde96fb8&quot;,&quot;58975f72-8ce2-4a0d-ad12-20300b771747&quot;,&quot;f3b1b578-3823-4a01-9f97-a4102bcb977d&quot;,&quot;dddf4536-332e-45bc-91c2-42b229500fa7&quot;,&quot;9614d561-819c-45b2-8fa9-4b64e0b5f763&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:53,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;b9a64e73-43ba-411e-9ce8-ea9d707b4dfb&quot;,&quot;title&quot;:&quot;Owner functions&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow not admin player to go to OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Owner functions should not allow not admin player to go to OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase);\nawait expect(\n   challenge.connect(signers[1]).startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;OwnableUnauthorizedAccount\&quot;).withArgs(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7c4aff5c-2911-498e-b8f6-374e5456713f&quot;,&quot;parentUUID&quot;:&quot;b9a64e73-43ba-411e-9ce8-ea9d707b4dfb&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7c4aff5c-2911-498e-b8f6-374e5456713f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;4f031fa4-4f9e-436e-b0f2-77d7bbe56042&quot;,&quot;title&quot;:&quot;State functions availability&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;6e4e3550-c50b-4aba-a3a1-2205f5329521&quot;,&quot;title&quot;:&quot;state GatheringPlayers&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers \&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;00b7d1f8-28e9-471c-9aa9-a298bcfba180&quot;,&quot;parentUUID&quot;:&quot;6e4e3550-c50b-4aba-a3a1-2205f5329521&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;57870d36-2f82-4cf7-a14f-412f111867b7&quot;,&quot;parentUUID&quot;:&quot;6e4e3550-c50b-4aba-a3a1-2205f5329521&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fcb5a61d-3b35-4ca8-801e-85c2874aa9e5&quot;,&quot;parentUUID&quot;:&quot;6e4e3550-c50b-4aba-a3a1-2205f5329521&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;57870d36-2f82-4cf7-a14f-412f111867b7&quot;,&quot;fcb5a61d-3b35-4ca8-801e-85c2874aa9e5&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;title&quot;:&quot;state OngoingChallenge&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge \&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de8c55e4-57a0-49ed-8e1c-038ce34f2ccc&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;205ac358-f565-4df7-b81c-22c7b7529bef&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c16a7960-902a-44aa-bde0-510355d4751b&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow startChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4d60e55-7a62-47a4-b659-6b8f61d8ebf2&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You are not allowed to vote now\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2fa1ac2c-606b-4f00-b015-38a12c4cc76a&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);\n//wait for challenge to end\nawait time.increase(duration);\n\n//should be allowed\nawait expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;\n//State should have changed\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.VotingForWinner);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0853d7b-d26b-4d02-bd4c-39dc9cc6cda8&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5204cb2c-a643-4462-b88d-92361e2ecf86&quot;,&quot;parentUUID&quot;:&quot;53369d85-cf07-4784-8e1e-4b63649bbf95&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;205ac358-f565-4df7-b81c-22c7b7529bef&quot;,&quot;c16a7960-902a-44aa-bde0-510355d4751b&quot;,&quot;a4d60e55-7a62-47a4-b659-6b8f61d8ebf2&quot;,&quot;2fa1ac2c-606b-4f00-b015-38a12c4cc76a&quot;,&quot;e0853d7b-d26b-4d02-bd4c-39dc9cc6cda8&quot;,&quot;5204cb2c-a643-4462-b88d-92361e2ecf86&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:11,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;c9012f28-30e6-4530-bd43-c0da7f3f5f38&quot;,&quot;title&quot;:&quot;state VotingForWinner&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner \&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8a18ee71-f95d-4969-8872-c9fa0021bd80&quot;,&quot;parentUUID&quot;:&quot;c9012f28-30e6-4530-bd43-c0da7f3f5f38&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow joinChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;355b5033-dbc1-4d6a-9245-7da75ad35fe5&quot;,&quot;parentUUID&quot;:&quot;c9012f28-30e6-4530-bd43-c0da7f3f5f38&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2ef698d-fefd-4754-80bf-a2125023efad&quot;,&quot;parentUUID&quot;:&quot;c9012f28-30e6-4530-bd43-c0da7f3f5f38&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow startChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e36ed0d7-2e07-4b54-8e8e-541d287022bc&quot;,&quot;parentUUID&quot;:&quot;c9012f28-30e6-4530-bd43-c0da7f3f5f38&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;355b5033-dbc1-4d6a-9245-7da75ad35fe5&quot;,&quot;a2ef698d-fefd-4754-80bf-a2125023efad&quot;,&quot;e36ed0d7-2e07-4b54-8e8e-541d287022bc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;title&quot;:&quot;state ChallengeWon&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon \&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid} = await loadFixture(EndingVoteFixture));\nawait challenge.endWinnerVote();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;758fe9fa-fc4f-4e87-8baf-e409483bb878&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow joinChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;351e78d0-e583-4f00-994e-0ab44e2bb9a5&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1cb4efa3-f537-4227-8a4e-1a72b422eed2&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow startChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ef3ab352-646c-47a5-82fe-374f5db4ae48&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow voteForWinner() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;21031c08-d568-4eb0-b51c-1b597a907b34&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7df6f14d-5296-4300-a28a-be9bcbb1a638&quot;,&quot;parentUUID&quot;:&quot;a70e6651-805f-46c2-871e-86f4ad42c817&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;351e78d0-e583-4f00-994e-0ab44e2bb9a5&quot;,&quot;1cb4efa3-f537-4227-8a4e-1a72b422eed2&quot;,&quot;ef3ab352-646c-47a5-82fe-374f5db4ae48&quot;,&quot;21031c08-d568-4eb0-b51c-1b597a907b34&quot;,&quot;7df6f14d-5296-4300-a28a-be9bcbb1a638&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:8,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;title&quot;:&quot;Events&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should emit an event when a Player Joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(deployedChallengeFixtureBase)\nawait expect(challenge.joinChallenge())\n    .to.emit(challenge, \&quot;PlayerJoined\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3f6a7037-0fac-474a-8777-ee9e508c7641&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a Player Withdraws from challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Withdraws from challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(deployedChallengeFixtureBase)\nawait challenge.joinChallenge();\nawait expect(challenge.withdrawFromChallenge())\n    .to.emit(challenge, \&quot;PlayerWithdrawn\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3626a053-49de-4bdf-b1ca-09427676ddd2&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeStarted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeStarted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase)\nawait challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait expect(challenge.startChallenge())\n    .to.emit(challenge, \&quot;ChallengeStarted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a4af5d15-441b-40bf-b05d-d3a5d6c50f6a&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeEnded &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeEnded &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(OngoingChallengeFixture)\n//Pass enough time\nawait time.increase(duration)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;ChallengeEnded\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aa2cbaac-a3af-4be7-8fce-0d2ed6c501c5&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when PlayerVoted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when PlayerVoted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:39,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(VotingForWinnerFixture)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;PlayerVoted\&quot;)\n    .withArgs(signers[0].address, signers[1].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b83c8171-8db2-49ee-bfe3-d3e404310569&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a prize is sent&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a prize is sent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(EndingVoteFixture)\n\nconst expectedPrize = bid*5n - 5n*bid*BigInt(gold)/100n;\nawait expect(await challenge.endWinnerVote())\n    .to.emit(challenge, \&quot;PrizeSent\&quot;)\n    .withArgs(signers[1].address, expectedPrize)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3d6573c5-0034-458b-ae0c-e16d26871178&quot;,&quot;parentUUID&quot;:&quot;15a466d0-cf89-49f6-b1e8-2fd36ab40933&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3f6a7037-0fac-474a-8777-ee9e508c7641&quot;,&quot;3626a053-49de-4bdf-b1ca-09427676ddd2&quot;,&quot;a4af5d15-441b-40bf-b05d-d3a5d6c50f6a&quot;,&quot;aa2cbaac-a3af-4be7-8fce-0d2ed6c501c5&quot;,&quot;b83c8171-8db2-49ee-bfe3-d3e404310569&quot;,&quot;3d6573c5-0034-458b-ae0c-e16d26871178&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:150,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;title&quot;:&quot;tests ChallengeFactory contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;tests ChallengeFactory contract\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract \&quot;before each\&quot; hook in \&quot;tests ChallengeFactory contract\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c81a029c-40c6-4390-9f61-c7243077e691&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should just deploy the challenge factory, and create a challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should just deploy the challenge factory, and create a challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bc1c9c7c-9ec2-4f40-9a37-03e06698a4f3&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(token.target, \&quot;0x0000000000000000000000000000000000000000\&quot;)\n).to.be.revertedWith(\&quot;the feeReceiver cannot be address 0!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dac736d4-ddde-4b1d-8dae-fd50e1340f8f&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event on new challenge deployment&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should emit an event on new challenge deployment&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filter = challengeFactory.filters.ChallengeCreated(signers[0].address);\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        expect(event.fragment.name).to.equal(&#x27;ChallengeCreated&#x27;)\n        const args = event.args\n        expect(args.admin).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;571ae38f-e0dc-40c9-8015-6aaed60997e5&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow to deploy a new challenge contract&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should allow to deploy a new challenge contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n        const filter = challengeFactory.filters.ChallengeCreated;\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        const newContractAddress = event.args.challengeAddress;\n        // 3. Attach to the deployed challenge\n        const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n        const challenge = Challenge.attach(newContractAddress);\n        // Verify initialisation\n        const _duration = await challenge.duration();\n        const _maxPlayers = await challenge.maxPlayers();\n        const _bid = await challenge.bid();\n        const _description = await challenge.description();\n        expect(_duration).to.equal(1000n);\n        expect(_maxPlayers).to.equal(5n);\n        expect(_bid).to.equal(bid);\n        expect(_description).to.equal(\&quot;test\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b6fce7a-416e-43b2-b1cb-c81c0c3e9920&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n        const filter = challengeFactory.filters.ChallengeCreated;\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        const newContractAddress = event.args.challengeAddress;\n        // 3. Attach to the deployed challenge\n        const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n        const challenge = Challenge.attach(newContractAddress);\n        const owner = await challenge.owner()\n        expect(owner).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ff64e17b-a314-4f14-8bc9-63cd5b9dccd2&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should be possible to access to all challenges previously created &quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should be possible to access to all challenges previously created &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 1. Call factory to create 2 more challenge contracts\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, []);\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, []);\n// 2. Extract the addresses from the events\nconst filter = challengeFactory.filters.ChallengeCreated;\nconst events = await challengeFactory.queryFilter(filter, 0, \&quot;latest\&quot;)\nconst addresses = events.map((event) =&gt; event.args.challengeAddress);\n// console.log(\&quot;deployed contract addresses : \&quot;, addresses)\n//Contract ABI\nconst Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\nfor (const addr of addresses) {\n    const challengeContract = Challenge.attach(addr);\n    // Now you can call read-only functions to confirm it&#x27;s really a deployed contract of this type\n    const _duration = await challengeContract.duration();\n    expect(_duration).to.equal(1000n); // simple check that contract responds\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;78b16d71-469d-4208-9fd1-c833c2ed9a6d&quot;,&quot;parentUUID&quot;:&quot;432c1f98-6ad1-4e28-aa03-357cf9c2c0a1&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;bc1c9c7c-9ec2-4f40-9a37-03e06698a4f3&quot;,&quot;dac736d4-ddde-4b1d-8dae-fd50e1340f8f&quot;,&quot;571ae38f-e0dc-40c9-8015-6aaed60997e5&quot;,&quot;2b6fce7a-416e-43b2-b1cb-c81c0c3e9920&quot;,&quot;ff64e17b-a314-4f14-8bc9-63cd5b9dccd2&quot;,&quot;78b16d71-469d-4208-9fd1-c833c2ed9a6d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:40000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportFilename&quot;:&quot;report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;report&quot;,&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-report/assets&quot;,&quot;jsonFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.json&quot;,&quot;htmlFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>