<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:15,&quot;tests&quot;:58,&quot;passes&quot;:58,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-07-22T12:47:14.764Z&quot;,&quot;end&quot;:&quot;2025-07-22T12:47:15.571Z&quot;,&quot;duration&quot;:807,&quot;testsRegistered&quot;:58,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;5886ebab-cfdd-4a44-9509-ace6a4fb09da&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;579cfe9e-a533-4ae6-a6a2-d4d849cd979b&quot;,&quot;title&quot;:&quot;tests Challenge contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d3c7a7f2-98c1-4a28-99dd-205ffa51f6ab&quot;,&quot;title&quot;:&quot;deployment&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment \&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\n//Token deployment\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75b8bd87-47c6-4e4e-8814-31ae5448a08f&quot;,&quot;parentUUID&quot;:&quot;d3c7a7f2-98c1-4a28-99dd-205ffa51f6ab&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should juste deploy the contract&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, false, [])\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9a511970-15dc-4a76-89a1-6b822c2768b4&quot;,&quot;parentUUID&quot;:&quot;d3c7a7f2-98c1-4a28-99dd-205ffa51f6ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, \&quot;0x0000000000000000000000000000000000000000\&quot;, false, [])\n).to.be.revertedWith(\&quot;the feeReceiver cannot be address 0!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;11827142-47cf-49df-b2a9-5a42f5cf91d2&quot;,&quot;parentUUID&quot;:&quot;d3c7a7f2-98c1-4a28-99dd-205ffa51f6ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE : should not be possible to deploy if one player in the array is address 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment GROUP MODE : should not be possible to deploy if one player in the array is address 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nconst playersArray = [signers[0].address, signers[1].address, \&quot;0x0000000000000000000000000000000000000000\&quot;]\nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, playersArray)\n).to.be.revertedWith(\&quot;address 0 cannot be a player!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e234868-021e-4cab-a0ee-0d3520f6e735&quot;,&quot;parentUUID&quot;:&quot;d3c7a7f2-98c1-4a28-99dd-205ffa51f6ab&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9a511970-15dc-4a76-89a1-6b822c2768b4&quot;,&quot;11827142-47cf-49df-b2a9-5a42f5cf91d2&quot;,&quot;5e234868-021e-4cab-a0ee-0d3520f6e735&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:27,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;title&quot;:&quot;gathering players state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state \&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;23b75cbe-e1f4-4ea7-8489-3a65a5bb94b1&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should store a player in the players array (sending enough money)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should store a player in the players array (sending enough money)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(challenge.joinChallenge())\n           .to.not.be.reverted;\n           await expect(challenge.connect(signers[1]).joinChallenge())\n           .to.not.be.reverted;\n           const player1 = await challenge.players(0);\n           expect(player1[0]).to.equal(signers[0].address);\n           const player2 = await challenge.players(1);\n           expect(player2[0]).to.equal(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ceab87b7-7c14-4d53-b459-b1481b0855f5&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.connect(signers[2]).joinChallenge();\nawait challenge.connect(signers[3]).joinChallenge();\nawait challenge.connect(signers[4]).joinChallenge();\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[2].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);\nconst player5 = await challenge.players(4);\nexpect(player5[0]).to.equal(signers[4].address);\nawait expect(challenge.connect(signers[5]).joinChallenge()).to.be.revertedWith(\&quot;This challenge is already full\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;bb0aa50d-74ce-47a7-9b0a-14328ff4408b&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a participant to join twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a participant to join twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait expect(challenge.joinChallenge()).to.be.revertedWith(\&quot;You already joined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;53a073db-9331-4300-abf7-f3d9ce23910a&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join if he did not approve enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join if he did not approve enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//signer 5 approves not enough tokens\nawait token.connect(signers[5]).approve(challenge.target, bid-1n);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge()\n).to.be.revertedWith(\&quot;Need prior approval for token spending\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbed7c05-a20b-4b67-bd7f-4c2ab1a905df&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:16,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//5 players join\nawait challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.connect(signers[2]).joinChallenge();\nawait challenge.connect(signers[3]).joinChallenge();\nawait challenge.connect(signers[4]).joinChallenge();\n//one player withdraws from challenge\nawait challenge.connect(signers[2]).withdrawFromChallenge();\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[4].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);\n//the 3rd player should not be in the array anymore, this should revert\nawait expect(\n    challenge.players(4)\n).to.be.reverted;\n//Admin successfully starts challenge\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6d4ffdbf-d032-402a-be64-305ab4929682&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;You are not in players list\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e0b9198f-c0c3-4f8c-a513-60473f65762e&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join, withdraw and then join again the challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, withdraw and then join again the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.withdrawFromChallenge();\nawait expect(\n   challenge.joinChallenge()\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5c4d3824-7aef-483c-98ff-7e1bf5822ce9&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to start the challenge if there is less than 2 players&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow to start the challenge if there is less than 2 players&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;challenge.joinChallenge();\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not enough players to start the challenge\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a52fbe1d-83ab-4f22-a676-2713f5006845&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert startChallenge() if a participant doesnt have enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should revert startChallenge() if a participant doesnt have enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge()\n//signer 0 sends tokens to signer 6, but not enough\nawait token.transfer(signers[6], bid-1n);\nawait token.connect(signers[6]).approve(challenge.target, bid);\nawait challenge.connect(signers[6]).joinChallenge()\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientBalance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5e0c375d-0001-4d2b-b28f-f7485186505f&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert startChallenge() if a participant did not approve enough tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should revert startChallenge() if a participant did not approve enough tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge()\n//signer 0 sends tokens to signer 6, but not enough\nawait token.transfer(signers[6], bid);\nawait token.connect(signers[6]).approve(challenge.target, bid);\nawait challenge.connect(signers[6]).joinChallenge()\n//lowers approval amount\nawait token.connect(signers[6]).approve(challenge.target, bid-1n);\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientAllowance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;752c4b04-78fe-440a-8a6e-eae3844ea2e0&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow the admin to go to the next state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow the admin to go to the next state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;90d52abc-1120-4a39-a0cc-a33cd60a8266&quot;,&quot;parentUUID&quot;:&quot;e03e64a8-644f-4b8b-8d5f-a4456252cfff&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;ceab87b7-7c14-4d53-b459-b1481b0855f5&quot;,&quot;bb0aa50d-74ce-47a7-9b0a-14328ff4408b&quot;,&quot;53a073db-9331-4300-abf7-f3d9ce23910a&quot;,&quot;fbed7c05-a20b-4b67-bd7f-4c2ab1a905df&quot;,&quot;6d4ffdbf-d032-402a-be64-305ab4929682&quot;,&quot;e0b9198f-c0c3-4f8c-a513-60473f65762e&quot;,&quot;5c4d3824-7aef-483c-98ff-7e1bf5822ce9&quot;,&quot;a52fbe1d-83ab-4f22-a676-2713f5006845&quot;,&quot;5e0c375d-0001-4d2b-b28f-f7485186505f&quot;,&quot;752c4b04-78fe-440a-8a6e-eae3844ea2e0&quot;,&quot;90d52abc-1120-4a39-a0cc-a33cd60a8266&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:70,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;e8447f5e-609d-4608-b59b-a53710d3f9dd&quot;,&quot;title&quot;:&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) \&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Deploying in group mode\n({challenge, signers, bid, token} = await loadFixture(groupModeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;495d2f43-c6ee-445d-9b0d-4a8761ee78e9&quot;,&quot;parentUUID&quot;:&quot;e8447f5e-609d-4608-b59b-a53710d3f9dd&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;FOR GROUP MODE : the stored array of players should be correct&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : the stored array of players should be correct&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.connect(signers[0]).joinChallenge()\nawait challenge.connect(signers[1]).joinChallenge()\nawait challenge.connect(signers[2]).joinChallenge()\nawait challenge.connect(signers[3]).joinChallenge()\n\nconst player1 = await challenge.players(0);\nexpect(player1[0]).to.equal(signers[0].address);\nconst player2 = await challenge.players(1);\nexpect(player2[0]).to.equal(signers[1].address);\nconst player3 = await challenge.players(2);\nexpect(player3[0]).to.equal(signers[2].address);\nconst player4 = await challenge.players(3);\nexpect(player4[0]).to.equal(signers[3].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c0726a3c-f2eb-49fe-8dec-1fee1ada80ed&quot;,&quot;parentUUID&quot;:&quot;e8447f5e-609d-4608-b59b-a53710d3f9dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.connect(signers[5]).joinChallenge()\n).to.be.revertedWith(\&quot;You are not allowed to join this challenge.\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7de89eb6-a4bc-4659-a6ea-608d4eed77ea&quot;,&quot;parentUUID&quot;:&quot;e8447f5e-609d-4608-b59b-a53710d3f9dd&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c0726a3c-f2eb-49fe-8dec-1fee1ada80ed&quot;,&quot;7de89eb6-a4bc-4659-a6ea-608d4eed77ea&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;d02d96b4-4dc1-419c-89bd-ff598738edd7&quot;,&quot;title&quot;:&quot;ongoing challenge state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state \&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:43,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ce978f38-d7cd-422b-8ad8-287d93106e85&quot;,&quot;parentUUID&quot;:&quot;d02d96b4-4dc1-419c-89bd-ff598738edd7&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;419c0be0-83ec-4c79-92fd-d9023117e3f7&quot;,&quot;parentUUID&quot;:&quot;d02d96b4-4dc1-419c-89bd-ff598738edd7&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;419c0be0-83ec-4c79-92fd-d9023117e3f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;title&quot;:&quot;voting for winner state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state \&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f643c7f5-8b10-410c-b2a1-addabffffd9e&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to vote (for another player). check that the vote is registered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow a player to vote (for another player). check that the vote is registered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nconst player2 = await challenge.players(1);\nexpect(player2[1]).to.equal(1);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a2c1f1d7-4d39-45a9-b0dd-74c7f3c1854f&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a non player to vote&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a non player to vote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n   challenge.connect(signers[5]).voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You are not a player. You cannot vote for winner.\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;68bac83f-256b-4bee-a8dd-61b28694a0f2&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to vote twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a player to vote twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nawait expect(\n   challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You have already voted.\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;43c8ad4c-e0f6-43f8-b8ff-2c1cdcc68051&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait expect(\n   challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not all player have voted for a winner yet (and minimum delay has not passed)\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b45382e4-39bc-4894-aaba-b2af3853d2b2&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\n//Pass enough time\nawait time.increase(votingDelay);\nawait expect(\n   challenge.connect(signers[2]).endWinnerVote()\n).not.to.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d68bfea7-631d-4a6b-a9a4-452fab5f46a0&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Any player can end vote, because everyone has voted\nawait challenge.connect(signers[1]).endWinnerVote();\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.ChallengeWon);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;75119e94-0864-43c3-9250-44b0a0d441ba&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Pass enough time\n            await time.increase(votingDelay);\n            //Any player can end vote, because everyone has voted\n            await expect(challenge.connect(signers[1]).endWinnerVote()).to.be.revertedWith(&#x27;Not allowed in this state&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;035358c8-6d3c-4683-89a3-56f19c202513&quot;,&quot;parentUUID&quot;:&quot;f948d8a0-a891-4dd3-bc14-ef52954d4e6f&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;a2c1f1d7-4d39-45a9-b0dd-74c7f3c1854f&quot;,&quot;68bac83f-256b-4bee-a8dd-61b28694a0f2&quot;,&quot;43c8ad4c-e0f6-43f8-b8ff-2c1cdcc68051&quot;,&quot;b45382e4-39bc-4894-aaba-b2af3853d2b2&quot;,&quot;d68bfea7-631d-4a6b-a9a4-452fab5f46a0&quot;,&quot;75119e94-0864-43c3-9250-44b0a0d441ba&quot;,&quot;035358c8-6d3c-4683-89a3-56f19c202513&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:30,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;title&quot;:&quot;challenge won state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state \&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fc91ae28-4663-41c7-bc98-e8b86a397f25&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;winner should receive prize when endWinnerVote() is triggered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should receive prize when endWinnerVote() is triggered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[2].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*bronze/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f5866359-b64d-4d44-9f90-869b11d66bba&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;if more tokens (signers[1] gold tier here) winner should receive more tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state if more tokens (signers[1] gold tier here) winner should receive more tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[0].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[1].address);\n//End vote\nawait challenge.endWinnerVote();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[1].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*gold/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;38f882ad-d694-4c46-96ee-3b585a6c3d89&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst balanceBefore = await token.balanceOf(signers[0].address);\n//End vote\nawait challenge.endWinnerVote();\nconst balanceAfter = await token.balanceOf(signers[0].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedFeesReceived = 5n*bid/2n*bronze/100n;\n\nexpect(\n    diff\n).to.equal(expectedFeesReceived);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d19a7f14-0d51-4f61-aba2-1d726e43b67b&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;half of the fees should have been burnt&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state half of the fees should have been burnt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[0].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[0].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst initialTotalSupply = await token.totalSupply();\n//End vote\nawait challenge.endWinnerVote();\nconst finalTotalSupply = await token.totalSupply();\nconst diff = initialTotalSupply - finalTotalSupply;\nconst expectedBurntAmount = bid*5n/2n*platinum/100n;\n\nexpect(\n    diff\n).to.equal(expectedBurntAmount);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ee780ffc-e115-4579-b2b3-93d809d1b821&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;When there is a tie, should allow both winners to receive prize&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state When there is a tie, should allow both winners to receive prize&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\n//Check balance before for both winners\nconst balanceBefore1 = await token.balanceOf(signers[1].address);\nconst balanceBefore2 = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\nconst winner1 = await challenge.challengeWinners(0)\nconst winner2 = await challenge.challengeWinners(1)\nexpect(winner1).to.equal(signers[2].address);\nexpect(winner2).to.equal(signers[1].address);\n//Check balance after (winner1)\nconst balanceAfter1 = await token.balanceOf(signers[1].address);\nconst diff1 = balanceAfter1 - balanceBefore1;\nconst expectedDiff1 = bid*5n/2n - bid*5n/2n*gold/100n;\nexpect(\n    diff1\n).to.equal(expectedDiff1);\n//Check balance after (winner2)\nconst balanceAfter2 = await token.balanceOf(signers[2].address);\nconst diff2 = balanceAfter2 - balanceBefore2;\nconst expectedDiff2 = bid*5n/2n - bid*5n/2n*bronze/100n;\nexpect(\n    diff2\n).to.equal(expectedDiff2); //substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a6b4c7d5-0e21-4239-a2dd-801df55ea381&quot;,&quot;parentUUID&quot;:&quot;36028486-b307-4941-add7-ee2ad8ae594d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;f5866359-b64d-4d44-9f90-869b11d66bba&quot;,&quot;38f882ad-d694-4c46-96ee-3b585a6c3d89&quot;,&quot;d19a7f14-0d51-4f61-aba2-1d726e43b67b&quot;,&quot;ee780ffc-e115-4579-b2b3-93d809d1b821&quot;,&quot;a6b4c7d5-0e21-4239-a2dd-801df55ea381&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:51,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;a9a465b5-a484-464d-91d3-ad04de58f277&quot;,&quot;title&quot;:&quot;Owner functions&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow not admin player to go to OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Owner functions should not allow not admin player to go to OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase);\nawait expect(\n   challenge.connect(signers[1]).startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;OwnableUnauthorizedAccount\&quot;).withArgs(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7e025c42-0d02-4c48-b3be-db66cfb65e71&quot;,&quot;parentUUID&quot;:&quot;a9a465b5-a484-464d-91d3-ad04de58f277&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7e025c42-0d02-4c48-b3be-db66cfb65e71&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;fe3032f2-435c-4e21-99fc-151703a10415&quot;,&quot;title&quot;:&quot;State functions availability&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;e263d59d-ee70-4545-82c2-22ecd0028bf6&quot;,&quot;title&quot;:&quot;state GatheringPlayers&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers \&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;76b236dc-f658-42f9-a843-fe45e811b203&quot;,&quot;parentUUID&quot;:&quot;e263d59d-ee70-4545-82c2-22ecd0028bf6&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;efec431c-bcfb-4865-8e91-2e0b38547e1b&quot;,&quot;parentUUID&quot;:&quot;e263d59d-ee70-4545-82c2-22ecd0028bf6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d1e65175-8bc1-4be3-8008-d9842b688baf&quot;,&quot;parentUUID&quot;:&quot;e263d59d-ee70-4545-82c2-22ecd0028bf6&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;efec431c-bcfb-4865-8e91-2e0b38547e1b&quot;,&quot;d1e65175-8bc1-4be3-8008-d9842b688baf&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;title&quot;:&quot;state OngoingChallenge&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge \&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d61168f3-8bee-4bec-b8e0-9c703857a24e&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9393bfe6-d8b1-4497-a8d9-7dfb12b7ccc5&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7b2a687a-c6d5-4976-b7a4-f65811f2a38b&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow startChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eaee053c-9a02-42c7-9b10-84236f83e02b&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;You are not allowed to vote now\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;225fbcbd-2275-483f-a6f3-233f6e6fb4e9&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);\n//wait for challenge to end\nawait time.increase(duration);\n\n//should be allowed\nawait expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;\n//State should have changed\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.VotingForWinner);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dd8bf6fc-a43c-41ee-bcdb-7c8bd23426b8&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9e4f0b72-8280-4452-96df-931b99bf54a0&quot;,&quot;parentUUID&quot;:&quot;f399a787-a68d-4328-a781-917bbb5043bf&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9393bfe6-d8b1-4497-a8d9-7dfb12b7ccc5&quot;,&quot;7b2a687a-c6d5-4976-b7a4-f65811f2a38b&quot;,&quot;eaee053c-9a02-42c7-9b10-84236f83e02b&quot;,&quot;225fbcbd-2275-483f-a6f3-233f6e6fb4e9&quot;,&quot;dd8bf6fc-a43c-41ee-bcdb-7c8bd23426b8&quot;,&quot;9e4f0b72-8280-4452-96df-931b99bf54a0&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:12,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;8c879b98-6058-48c1-9ad3-d54de520cb94&quot;,&quot;title&quot;:&quot;state VotingForWinner&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner \&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c9544b33-4306-4ffb-88f1-15552eac6434&quot;,&quot;parentUUID&quot;:&quot;8c879b98-6058-48c1-9ad3-d54de520cb94&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow joinChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77b88a8b-ba73-43ab-b2f8-ec8a096a03d7&quot;,&quot;parentUUID&quot;:&quot;8c879b98-6058-48c1-9ad3-d54de520cb94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e9ed8434-af0d-40f1-b731-0195e2e7edb5&quot;,&quot;parentUUID&quot;:&quot;8c879b98-6058-48c1-9ad3-d54de520cb94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow startChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;74bb3648-f232-4534-9f46-c6ad529fb87b&quot;,&quot;parentUUID&quot;:&quot;8c879b98-6058-48c1-9ad3-d54de520cb94&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;77b88a8b-ba73-43ab-b2f8-ec8a096a03d7&quot;,&quot;e9ed8434-af0d-40f1-b731-0195e2e7edb5&quot;,&quot;74bb3648-f232-4534-9f46-c6ad529fb87b&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:4,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;title&quot;:&quot;state ChallengeWon&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon \&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid} = await loadFixture(EndingVoteFixture));\nawait challenge.endWinnerVote();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7106cf35-6d08-4704-b82e-9cecc2cb9c1e&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow joinChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.joinChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de4bc2a9-f213-475f-ac43-441c930db787&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;059a59fb-cda2-444f-ae14-a54a1b2b88c2&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow startChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;96a2e2fb-bec7-402d-8619-0aefad283735&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow voteForWinner() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db55164c-4df1-4214-a59a-016d2b044e1e&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWith(\&quot;Not allowed in this state\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a16009c9-0933-48b3-ab79-a0ce032e94f2&quot;,&quot;parentUUID&quot;:&quot;37f9bdde-90ba-4e2d-b736-07ba50167d2a&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;de4bc2a9-f213-475f-ac43-441c930db787&quot;,&quot;059a59fb-cda2-444f-ae14-a54a1b2b88c2&quot;,&quot;96a2e2fb-bec7-402d-8619-0aefad283735&quot;,&quot;db55164c-4df1-4214-a59a-016d2b044e1e&quot;,&quot;a16009c9-0933-48b3-ab79-a0ce032e94f2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:9,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;title&quot;:&quot;Events&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should emit an event when a Player Joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(deployedChallengeFixtureBase)\nawait expect(challenge.joinChallenge())\n    .to.emit(challenge, \&quot;PlayerJoined\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20c1ead7-46bd-4b0d-9ef7-5519d47988be&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a Player Withdraws from challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Withdraws from challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(deployedChallengeFixtureBase)\nawait challenge.joinChallenge();\nawait expect(challenge.withdrawFromChallenge())\n    .to.emit(challenge, \&quot;PlayerWithdrawn\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;07a5cae8-618e-4bf8-992b-b2307964936c&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeStarted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeStarted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase)\nawait challenge.joinChallenge();\nawait challenge.connect(signers[1]).joinChallenge();\nawait expect(challenge.startChallenge())\n    .to.emit(challenge, \&quot;ChallengeStarted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b42dd648-455d-4536-97a2-c8a8c675933e&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeEnded &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeEnded &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(OngoingChallengeFixture)\n//Pass enough time\nawait time.increase(duration)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;ChallengeEnded\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;edfb925d-1856-49e0-876c-d233682c0433&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when PlayerVoted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when PlayerVoted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:52,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(VotingForWinnerFixture)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;PlayerVoted\&quot;)\n    .withArgs(signers[0].address, signers[1].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5bca3f8a-5908-4f2c-bec2-9836118d6ce7&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a prize is sent&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a prize is sent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:51,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(EndingVoteFixture)\n\nconst expectedPrize = bid*5n - 5n*bid*BigInt(gold)/100n;\nawait expect(await challenge.endWinnerVote())\n    .to.emit(challenge, \&quot;PrizeSent\&quot;)\n    .withArgs(signers[1].address, expectedPrize)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;5048290a-3eb2-49d7-8200-85c192bae48f&quot;,&quot;parentUUID&quot;:&quot;b31955f6-473f-45e4-a364-8f0a57e47210&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;20c1ead7-46bd-4b0d-9ef7-5519d47988be&quot;,&quot;07a5cae8-618e-4bf8-992b-b2307964936c&quot;,&quot;b42dd648-455d-4536-97a2-c8a8c675933e&quot;,&quot;edfb925d-1856-49e0-876c-d233682c0433&quot;,&quot;5bca3f8a-5908-4f2c-bec2-9836118d6ce7&quot;,&quot;5048290a-3eb2-49d7-8200-85c192bae48f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:170,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;title&quot;:&quot;tests ChallengeFactory contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;tests ChallengeFactory contract\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract \&quot;before each\&quot; hook in \&quot;tests ChallengeFactory contract\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8b9e27e3-7e90-4b7e-9f46-0113d550608c&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should just deploy the challenge factory, and create a challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should just deploy the challenge factory, and create a challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7fbb96bd-f631-4695-9f43-e8d81f951042&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should should not be possible to deploy with a feeReceiver address to 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:12,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(token.target, \&quot;0x0000000000000000000000000000000000000000\&quot;)\n).to.be.revertedWith(\&quot;the feeReceiver cannot be address 0!\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da0d8fba-a644-47b9-aebb-b3e1db1214fe&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event on new challenge deployment&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should emit an event on new challenge deployment&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filter = challengeFactory.filters.ChallengeCreated(signers[0].address);\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        expect(event.fragment.name).to.equal(&#x27;ChallengeCreated&#x27;)\n        const args = event.args\n        expect(args.admin).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fdf8ac78-aa7e-4494-98bf-17cae899530a&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow to deploy a new challenge contract&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should allow to deploy a new challenge contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n        const filter = challengeFactory.filters.ChallengeCreated;\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        const newContractAddress = event.args.challengeAddress;\n        // 3. Attach to the deployed challenge\n        const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n        const challenge = Challenge.attach(newContractAddress);\n        // Verify initialisation\n        const _duration = await challenge.duration();\n        const _maxPlayers = await challenge.maxPlayers();\n        const _bid = await challenge.bid();\n        const _description = await challenge.description();\n        expect(_duration).to.equal(1000n);\n        expect(_maxPlayers).to.equal(5n);\n        expect(_bid).to.equal(bid);\n        expect(_description).to.equal(\&quot;test\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4dd842d6-6456-4769-b556-a6cbe9467533&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n        const filter = challengeFactory.filters.ChallengeCreated;\n        const events = await challengeFactory.queryFilter(filter, -1)\n        const event = events[0]\n        const newContractAddress = event.args.challengeAddress;\n        // 3. Attach to the deployed challenge\n        const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n        const challenge = Challenge.attach(newContractAddress);\n        const owner = await challenge.owner()\n        expect(owner).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7af9f560-6445-4a88-8074-6f287e8ecd44&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should be possible to access to all challenges previously created &quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract should be possible to access to all challenges previously created &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 1. Call factory to create 2 more challenge contracts\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, []);\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, []);\n// 2. Extract the addresses from the events\nconst filter = challengeFactory.filters.ChallengeCreated;\nconst events = await challengeFactory.queryFilter(filter, 0, \&quot;latest\&quot;)\nconst addresses = events.map((event) =&gt; event.args.challengeAddress);\n// console.log(\&quot;deployed contract addresses : \&quot;, addresses)\n//Contract ABI\nconst Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\nfor (const addr of addresses) {\n    const challengeContract = Challenge.attach(addr);\n    // Now you can call read-only functions to confirm it&#x27;s really a deployed contract of this type\n    const _duration = await challengeContract.duration();\n    expect(_duration).to.equal(1000n); // simple check that contract responds\n}&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;eb95f9bb-3fc8-4e8e-9604-9e5e63e652f7&quot;,&quot;parentUUID&quot;:&quot;f7a14280-c060-4da0-93be-31a6f2b33f32&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7fbb96bd-f631-4695-9f43-e8d81f951042&quot;,&quot;da0d8fba-a644-47b9-aebb-b3e1db1214fe&quot;,&quot;fdf8ac78-aa7e-4494-98bf-17cae899530a&quot;,&quot;4dd842d6-6456-4769-b556-a6cbe9467533&quot;,&quot;7af9f560-6445-4a88-8074-6f287e8ecd44&quot;,&quot;eb95f9bb-3fc8-4e8e-9604-9e5e63e652f7&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:34,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:40000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportFilename&quot;:&quot;report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;report&quot;,&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-report/assets&quot;,&quot;jsonFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.json&quot;,&quot;htmlFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>