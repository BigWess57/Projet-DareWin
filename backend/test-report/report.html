<!doctype html>
<html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Mochawesome Report</title><link rel="stylesheet" href="assets/app.css"/></head><body data-raw="{&quot;stats&quot;:{&quot;suites&quot;:19,&quot;tests&quot;:78,&quot;passes&quot;:78,&quot;pending&quot;:0,&quot;failures&quot;:0,&quot;start&quot;:&quot;2025-12-01T18:23:17.849Z&quot;,&quot;end&quot;:&quot;2025-12-01T18:23:18.968Z&quot;,&quot;duration&quot;:1119,&quot;testsRegistered&quot;:78,&quot;passPercent&quot;:100,&quot;pendingPercent&quot;:0,&quot;other&quot;:0,&quot;hasOther&quot;:false,&quot;skipped&quot;:0,&quot;hasSkipped&quot;:false},&quot;results&quot;:[{&quot;uuid&quot;:&quot;b5c9f194-8cbc-4e0a-b15a-7b6aae753aeb&quot;,&quot;title&quot;:&quot;&quot;,&quot;fullFile&quot;:&quot;&quot;,&quot;file&quot;:&quot;&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d8eb5643-449d-42bf-b331-4b77e3ab1dab&quot;,&quot;title&quot;:&quot;tests Challenge contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;8ef31c42-8446-42df-92e3-2f72d34e7d04&quot;,&quot;title&quot;:&quot;deployment&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment \&quot;before each\&quot; hook in \&quot;deployment\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\n//Token deployment\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29d5d23a-ab57-429a-9603-452b2d77d739&quot;,&quot;parentUUID&quot;:&quot;8ef31c42-8446-42df-92e3-2f72d34e7d04&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should juste deploy the contract&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Challenge Deployment\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, false, ethers.ZeroHash, \&quot;ipfsCid\&quot;)\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0b984dc3-f26b-4d4e-b914-9d196272b8f1&quot;,&quot;parentUUID&quot;:&quot;8ef31c42-8446-42df-92e3-2f72d34e7d04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should juste deploy the contract in Group mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment should juste deploy the contract in Group mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const playersAllowed = [\n    [signers[0].address],\n    [signers[1].address],\n    [signers[2].address],\n    [signers[3].address],\n    [signers[4].address]\n]\nmerkleTree = StandardMerkleTree.of(playersAllowed, [\&quot;address\&quot;]);\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\n//Challenge Deployment\nawait expect(\n    challenge = await Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, merkleTree.root, \&quot;ipfsCid\&quot;)\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;20d0e842-5610-4d95-968b-6f713ef025be&quot;,&quot;parentUUID&quot;:&quot;8ef31c42-8446-42df-92e3-2f72d34e7d04&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;title&quot;:&quot;Constructor Validation Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Constructor Validation Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests \&quot;before each\&quot; hook in \&quot;Constructor Validation Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;signers = await ethers.getSigners();\nconst DareWinToken = await ethers.getContractFactory(&#x27;DareWin&#x27;);\ntoken = await DareWinToken.deploy(signers[0].address);\nbid = ethers.parseUnits(\&quot;1000\&quot;, await token.decimals());&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de5de40a-78e5-4b68-b1e2-87f0a37c6fd2&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should revert with ZeroAddressToken when token address is zero&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with ZeroAddressToken when token address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        \&quot;0x0000000000000000000000000000000000000000\&quot;, // Invalid token\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;ZeroAddressToken\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;14bd624d-9b78-4f77-97b6-450a0b092737&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with ZeroAddressFeeReceiver when feeReceiver address is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with ZeroAddressFeeReceiver when feeReceiver address is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target, // Invalid token\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        \&quot;0x0000000000000000000000000000000000000000\&quot;,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;ZeroAddressFeeReceiver\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;92f328aa-5976-4d7f-8d15-447671b4c115&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidDuration when duration is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InvalidDuration when duration is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        0n, // Invalid duration\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InvalidDuration\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3c48cc5-eab1-4f82-99bf-e6690ed6b407&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers = 1 (&lt; 2) in LINK mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientPlayers when maxPlayers = 1 (&lt; 2) in LINK mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        1n, // Invalid: less than 2\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa20f04c-bb73-43dd-8488-6795df810c7b&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers = 0 (&lt; 2) in LINK mode&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientPlayers when maxPlayers = 0 (&lt; 2) in LINK mode&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        0n, // Invalid: less than 2\n        bid,\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f19d181-2b96-4ee8-8554-49e8d19fcd52&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientBid when bid is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests should revert with InsufficientBid when bid is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        maxPlayers,\n        0n, // Invalid bid\n        description,\n        signers[0].address,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;InsufficientBid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f82a959e-afb7-4d52-83a1-f9b9b8e639a2&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE: should revert with IPFSCidEmpty when IPFS CID is empty&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests GROUP MODE: should revert with IPFSCidEmpty when IPFS CID is empty&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const playersAllowed = [\n    [signers[0].address],\n    [signers[1].address]\n];\nconst merkleTree = StandardMerkleTree.of(playersAllowed, [\&quot;address\&quot;]);\n\nconst Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;);\nawait expect(\n    Challenge.deploy(\n        signers[0].address,\n        token.target,\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        signers[0].address,\n        true, // Group mode\n        merkleTree.root,\n        \&quot;\&quot; // Empty IPFS CID\n    )\n).to.be.revertedWithCustomError(Challenge, \&quot;IPFSCidEmpty\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cad5c7fd-c3a0-40db-a1b6-836db0f450f4&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;GROUP MODE : should revert with MerkleRootRequired if the merkle root is 0&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract deployment Constructor Validation Tests GROUP MODE : should revert with MerkleRootRequired if the merkle root is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const Challenge = await ethers.getContractFactory(&#x27;Challenge&#x27;); \nawait expect(\n    Challenge.deploy(signers[0].address, token.target, duration, maxPlayers, bid, description, signers[0].address, true, ethers.ZeroHash, \&quot;ipfsCid\&quot;)\n).to.be.revertedWithCustomError(Challenge, \&quot;MerkleRootRequired\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84bc3d01-23a7-4383-9cba-893b92c4e738&quot;,&quot;parentUUID&quot;:&quot;457e34a1-ea8d-476f-aab5-9fdba81134ba&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;14bd624d-9b78-4f77-97b6-450a0b092737&quot;,&quot;92f328aa-5976-4d7f-8d15-447671b4c115&quot;,&quot;d3c48cc5-eab1-4f82-99bf-e6690ed6b407&quot;,&quot;fa20f04c-bb73-43dd-8488-6795df810c7b&quot;,&quot;4f19d181-2b96-4ee8-8554-49e8d19fcd52&quot;,&quot;f82a959e-afb7-4d52-83a1-f9b9b8e639a2&quot;,&quot;cad5c7fd-c3a0-40db-a1b6-836db0f450f4&quot;,&quot;84bc3d01-23a7-4383-9cba-893b92c4e738&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:53,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[&quot;0b984dc3-f26b-4d4e-b914-9d196272b8f1&quot;,&quot;20d0e842-5610-4d95-968b-6f713ef025be&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:21,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;title&quot;:&quot;gathering players state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state \&quot;before each\&quot; hook in \&quot;gathering players state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8c2c006b-8b01-4c5e-b83f-6ee707095336&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to join, and sends the money to the challenge contract correctly&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, and sends the money to the challenge contract correctly&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v, r, s, deadline } = await GetRSVsig(signers[0], token, bid, challenge);\nexpect(\n    await token.balanceOf(challenge)\n).to.equal(0)\nawait expect(\n    challenge.joinChallenge(deadline, v, r, s, [])\n)\n.to.not.be.reverted;\n\nexpect(\n    await token.balanceOf(challenge)\n).to.equal(bid)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c55ffde4-30cc-482a-9ad6-3b25327e3266&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join if the permit is wrong&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join if the permit is wrong&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v, r, s, deadline } = await GetRSVsig(signers[1], token, bid, challenge);\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline, v, r, s, [])\n)\n.to.be.revertedWithCustomError(token, \&quot;ERC20InsufficientAllowance\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;44a64e5a-8525-4174-8b1f-fc9a19c21253&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state FOR LINK MODE : should not allow any more participants to join if the max is already reached&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:26,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\nconst { v: v5, r: r5, s: s5, deadline: deadline5 } = await GetRSVsig(signers[4], token, bid, challenge);\nconst { v: v6, r: r6, s: s6, deadline: deadline6 } = await GetRSVsig(signers[5], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);  \nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, []);\nawait challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, []);\nawait challenge.connect(signers[4]).joinChallenge(deadline5, v5, r5, s5, []);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge(deadline6, v6, r6, s6, [])\n).to.be.revertedWithCustomError(challenge, \&quot;ChallengeFull\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7a3dc196-2c2f-43ab-bc06-c48cce7b1cc6&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a participant to join twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a participant to join twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(challenge.joinChallenge(deadline1, v1, r1, s1, [])).to.be.revertedWithCustomError(challenge, \&quot;AlreadyJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a8372d09-85a3-4917-b001-047aac46768d&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join even if his permit has been frontran (avoid DoS)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join even if his permit has been frontran (avoid DoS)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\n//Frontrun the permit call\nawait token.permit(signers[0].address, challenge, bid, deadline1, v1, r1, s1);\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline1, v1, r1, s1, [])\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;181ea8c9-c79b-48d8-8688-21fcba4db5ea&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues. Money should be sent back to him&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to withdraw from the challenge (before start), while letting the challenge start when required without issues. Money should be sent back to him&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:24,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//5 players join\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\nconst { v: v5, r: r5, s: s5, deadline: deadline5 } = await GetRSVsig(signers[4], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, []);\nawait challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, []);\nawait challenge.connect(signers[4]).joinChallenge(deadline5, v5, r5, s5, []);\n//one player withdraws from challenge\nexpect(\n    await token.balanceOf(signers[2].address)\n).to.equal(0);\nawait challenge.connect(signers[2]).withdrawFromChallenge();\n//His balance should be 1000\nexpect(\n    await token.balanceOf(signers[2].address)\n).to.equal(bid);\n//Admin successfully starts challenge\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;634f58e5-3deb-4032-bb86-dee0d3eeeb96&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to withdraw from the challenge if he hasnt joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;NotJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fd900c3f-1cd8-4969-811f-d84b793eb825&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to join, and then withdraw twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow a player to join, and then withdraw twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.withdrawFromChallenge();\n//try to withdraw without having joined, reverts\nawait expect(\n   challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;NotJoined\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;244e6b86-738a-473d-8bbf-d11f55afc767&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow a player to join, withdraw and then join again the challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow a player to join, withdraw and then join again the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Needed twice, because of the nonce\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\n\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.withdrawFromChallenge();\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n   challenge.joinChallenge(deadline2, v2, r2, s2, [])\n).to.not.be.reverted&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;8dd9e006-7b77-4407-9c0c-214a60627639&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to start the challenge if there is less than 2 players&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should not allow to start the challenge if there is less than 2 players&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InsufficientPlayersToStart\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2bf66760-fe30-471c-8ced-93cf457fae21&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow the admin to go to the next state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state should allow the admin to go to the next state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait challenge.startChallenge();\nexpect(\n   await challenge.currentStatus()\n).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;65037e03-9de9-4d79-9b7c-9033db372dfc&quot;,&quot;parentUUID&quot;:&quot;51eec06d-2a35-467f-a1dc-e9f995ed1f70&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c55ffde4-30cc-482a-9ad6-3b25327e3266&quot;,&quot;44a64e5a-8525-4174-8b1f-fc9a19c21253&quot;,&quot;7a3dc196-2c2f-43ab-bc06-c48cce7b1cc6&quot;,&quot;a8372d09-85a3-4917-b001-047aac46768d&quot;,&quot;181ea8c9-c79b-48d8-8688-21fcba4db5ea&quot;,&quot;634f58e5-3deb-4032-bb86-dee0d3eeeb96&quot;,&quot;fd900c3f-1cd8-4969-811f-d84b793eb825&quot;,&quot;244e6b86-738a-473d-8bbf-d11f55afc767&quot;,&quot;8dd9e006-7b77-4407-9c0c-214a60627639&quot;,&quot;2bf66760-fe30-471c-8ced-93cf457fae21&quot;,&quot;65037e03-9de9-4d79-9b7c-9033db372dfc&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:117,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;cec294bc-49e6-43e0-aea6-0c9d0553a571&quot;,&quot;title&quot;:&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) \&quot;before each\&quot; hook in \&quot;gathering players state (FOR GROUP MODE SPECIFIC TESTS)\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Deploying in group mode\n({challenge, signers, bid, token, merkleTree} = await loadFixture(groupModeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;abea40b3-bab5-48f2-b58c-c43a9747094f&quot;,&quot;parentUUID&quot;:&quot;cec294bc-49e6-43e0-aea6-0c9d0553a571&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;FOR GROUP MODE : should still allow players to join&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should still allow players to join&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:22,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nconst { v: v3, r: r3, s: s3, deadline: deadline3 } = await GetRSVsig(signers[2], token, bid, challenge);\nconst { v: v4, r: r4, s: s4, deadline: deadline4 } = await GetRSVsig(signers[3], token, bid, challenge);\n//Get merkle proof for each player\nconst proof1 = merkleTree.getProof([signers[0].address]);\nconst proof2 = merkleTree.getProof([signers[1].address]);\nconst proof3 = merkleTree.getProof([signers[2].address]);\nconst proof4 = merkleTree.getProof([signers[3].address]);\n//join with proof\nawait expect(\n    challenge.connect(signers[0]).joinChallenge(deadline1, v1, r1, s1, proof1)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, proof2)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[2]).joinChallenge(deadline3, v3, r3, s3, proof3)\n).to.not.be.reverted;\nawait expect(\n    challenge.connect(signers[3]).joinChallenge(deadline4, v4, r4, s4, proof4)\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e3272c60-916a-4d56-89c0-37ccafd2216b&quot;,&quot;parentUUID&quot;:&quot;cec294bc-49e6-43e0-aea6-0c9d0553a571&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract gathering players state (FOR GROUP MODE SPECIFIC TESTS) FOR GROUP MODE : should not allow a player to join if he is not among those chosen by the admin at creation&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[5], token, bid, challenge);\nconst proof1 = merkleTree.getProof([signers[0].address]);\nawait expect(\n    challenge.connect(signers[5]).joinChallenge(deadline1, v1, r1, s1, proof1)\n).to.be.revertedWithCustomError(challenge, \&quot;NotWhitelisted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;69b153f2-7037-461d-9f52-dee8bf7039ce&quot;,&quot;parentUUID&quot;:&quot;cec294bc-49e6-43e0-aea6-0c9d0553a571&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e3272c60-916a-4d56-89c0-37ccafd2216b&quot;,&quot;69b153f2-7037-461d-9f52-dee8bf7039ce&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:25,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;c1b56850-c16f-4c00-b7cd-43e0a1abb3f3&quot;,&quot;title&quot;:&quot;ongoing challenge state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state \&quot;before each\&quot; hook in \&quot;ongoing challenge state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:44,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9f155b83-d1f9-49ee-8002-3143696dbeac&quot;,&quot;parentUUID&quot;:&quot;c1b56850-c16f-4c00-b7cd-43e0a1abb3f3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract ongoing challenge state state should be \&quot;OngoingChallenge\&quot; during the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1743691a-6b02-46b8-a9bf-603a06b7292c&quot;,&quot;parentUUID&quot;:&quot;c1b56850-c16f-4c00-b7cd-43e0a1abb3f3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;1743691a-6b02-46b8-a9bf-603a06b7292c&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:1,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;title&quot;:&quot;voting for winner state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state \&quot;before each\&quot; hook in \&quot;voting for winner state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c12af62d-c1e3-41ca-ba0d-c5b6b1a5b292&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should allow a player to vote (for another player).&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow a player to vote (for another player).&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;9de6c617-2e25-402d-8c4a-b72a4a772013&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a non player to vote&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a non player to vote&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n   challenge.connect(signers[5]).voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;NotAPlayer\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;1a7ade8a-d626-4887-ada8-571d915913a9&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow a player to vote twice&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow a player to vote twice&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address);\nawait expect(\n   challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;AlreadyVoted\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;79ab7d0a-da7c-4d7f-9c5e-273c6aac9891&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidVoteTarget when voting for non-player&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should revert with InvalidVoteTarget when voting for non-player&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[5].address) // signer[5] never joined\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidVoteTarget\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d3ee1fcb-eded-404a-b282-90fed177a64b&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidVoteTarget when voting for zero address&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should revert with InvalidVoteTarget when voting for zero address&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(ethers.ZeroAddress)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidVoteTarget\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d2d627d9-1f20-4268-ab2d-5e395f6237e6&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow to go to next state (ChallengeWon) if everyone has not voted (and minimum delay hasn&#x27;t passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait expect(\n   challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;VotingStillOngoing\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;29be74f2-0610-4d29-934d-d1e22f46fc04&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) if everyone has not voted but minimum delay has passed&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\n//Pass enough time\nawait time.increase(votingDelay);\nawait expect(\n   challenge.connect(signers[2]).endWinnerVote()\n).not.to.be.reverted;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;da6f0fe9-6029-4660-8f52-564116a3352a&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should allow ANYONE to go to next state (ChallengeWon) when everyone voted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Any player can end vote, because everyone has voted\nawait challenge.connect(signers[1]).endWinnerVote();\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.ChallengeWon);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;54f5a82b-e07e-4731-aed6-d078f38c5567&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract voting for winner state should not allow ANYONE to go to next state (ChallengeWon) if no one has voted (even if time has passed)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Pass enough time\n            await time.increase(votingDelay);\n            //Any player can end vote, because everyone has voted\n            await expect(challenge.connect(signers[1]).endWinnerVote()).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aea5cba1-5b45-4dfe-9600-df7669e292c3&quot;,&quot;parentUUID&quot;:&quot;50e962c1-9aa5-4421-b1cd-e8beaf9317f2&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;9de6c617-2e25-402d-8c4a-b72a4a772013&quot;,&quot;1a7ade8a-d626-4887-ada8-571d915913a9&quot;,&quot;79ab7d0a-da7c-4d7f-9c5e-273c6aac9891&quot;,&quot;d3ee1fcb-eded-404a-b282-90fed177a64b&quot;,&quot;d2d627d9-1f20-4268-ab2d-5e395f6237e6&quot;,&quot;29be74f2-0610-4d29-934d-d1e22f46fc04&quot;,&quot;da6f0fe9-6029-4660-8f52-564116a3352a&quot;,&quot;54f5a82b-e07e-4731-aed6-d078f38c5567&quot;,&quot;aea5cba1-5b45-4dfe-9600-df7669e292c3&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:28,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;title&quot;:&quot;challenge won state&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state \&quot;before each\&quot; hook in \&quot;challenge won state\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;16b354d1-bee8-48f6-8cd9-36210ffd7402&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;winner should be able to retrieve prize when endWinnerVote() is triggered&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should be able to retrieve prize when endWinnerVote() is triggered&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[2].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[2].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*bronze/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;708023ba-5e74-4efa-b0ad-570e592164d4&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with NotAWinner when non-winner tries to withdraw&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state should revert with NotAWinner when non-winner tries to withdraw&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// signers[2] has 2 votes, signers[1] has 3 votes (winner)\n// signers[0] has 0 votes, signers[3] has 0 votes, signers[4] has 0 votes\n//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait expect(\n    challenge.connect(signers[0]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;NotAWinner\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;db785516-428d-4fb5-8ad6-10583f69b73b&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with NotAWinner when player with votes (but not highest) tries to withdraw&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state should revert with NotAWinner when player with votes (but not highest) tries to withdraw&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:15,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// In EndingVoteFixture, signers[2] has 2 votes but signers[1] has 3 (highest)\n//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait expect(\n    challenge.connect(signers[1]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;NotAWinner\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d44a6003-51c0-45a3-a5af-19d71650ffe8&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;winner should NOT be able to retrieve prize multiple times&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state winner should NOT be able to retrieve prize multiple times&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[2].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\nawait expect(\n    challenge.connect(signers[2]).withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;PrizeAlreadyWithdrawn\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0a34ba8e-d366-45f1-a754-aa921ce911b6&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;When there is a tie, should allow both winners to receive prize&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state When there is a tie, should allow both winners to receive prize&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[3].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[3].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\n//Check balance before for both winners\nconst balanceBefore1 = await token.balanceOf(signers[1].address);\nconst balanceBefore2 = await token.balanceOf(signers[3].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[1]).withdrawPrize();\n//Check balance after (winner1)\nconst balanceAfter1 = await token.balanceOf(signers[1].address);\nconst diff1 = balanceAfter1 - balanceBefore1;\nconst expectedDiff1 = bid*5n/2n - bid*5n/2n*gold/100n;\nexpect(\n    diff1\n).to.equal(expectedDiff1);\nawait challenge.connect(signers[3]).withdrawPrize();\n//Check balance after (winner2)\nconst balanceAfter2 = await token.balanceOf(signers[3].address);\nconst diff2 = balanceAfter2 - balanceBefore2;\nconst expectedDiff2 = bid*5n/2n - bid*5n/2n*silver/100n;\nexpect(\n    diff2\n).to.equal(expectedDiff2); //substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;ec7a833e-9f5b-4817-a6a1-d49b4c5894f3&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;if more tokens (signers[1] gold tier here), winner should receive more tokens&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state if more tokens (signers[1] gold tier here), winner should receive more tokens&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:9,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[1].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[2]).voteForWinner(signers[1].address) \nawait challenge.connect(signers[3]).voteForWinner(signers[0].address) \nawait challenge.connect(signers[4]).voteForWinner(signers[2].address) \n//Check balance before\nconst balanceBefore = await token.balanceOf(signers[1].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[1]).withdrawPrize();\n//Check balance after\nconst balanceAfter = await token.balanceOf(signers[1].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedDiff = bid*5n - 5n*bid*gold/100n;\n//Difference should be equal to cash prize won\nexpect(diff).to.equal(expectedDiff); // substract fees too&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b978d824-4ee0-41aa-9c53-e41edf73cc22&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state fee receiver should receive half of the fees (the rest is burnt)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:10,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[2].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst balanceBefore = await token.balanceOf(signers[0].address);\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[2]).withdrawPrize();\nconst balanceAfter = await token.balanceOf(signers[0].address);\nconst diff = balanceAfter - balanceBefore;\nconst expectedFeesReceived = 5n*bid/2n*bronze/100n;\n\nexpect(\n    diff\n).to.equal(expectedFeesReceived);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;810fc0fb-5186-4a45-9e9d-7a1fbd114b10&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;half of the fees should have been burnt&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract challenge won state half of the fees should have been burnt&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:8,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;//Players voting\nawait challenge.voteForWinner(signers[0].address)\nawait challenge.connect(signers[1]).voteForWinner(signers[0].address)\nawait challenge.connect(signers[2]).voteForWinner(signers[2].address)\nawait challenge.connect(signers[3]).voteForWinner(signers[1].address)\nawait challenge.connect(signers[4]).voteForWinner(signers[4].address)\nconst initialTotalSupply = await token.totalSupply();\n//End vote\nawait challenge.endWinnerVote();\nawait challenge.connect(signers[0]).withdrawPrize();\nconst finalTotalSupply = await token.totalSupply();\nconst diff = initialTotalSupply - finalTotalSupply;\nconst expectedBurntAmount = bid*5n/2n*platinum/100n;\n\nexpect(\n    diff\n).to.equal(expectedBurntAmount);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;aaee6af0-abf7-412d-aad5-e4781655ce40&quot;,&quot;parentUUID&quot;:&quot;5f1c03f0-b177-4002-8f53-62ce47ef4387&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;708023ba-5e74-4efa-b0ad-570e592164d4&quot;,&quot;db785516-428d-4fb5-8ad6-10583f69b73b&quot;,&quot;d44a6003-51c0-45a3-a5af-19d71650ffe8&quot;,&quot;0a34ba8e-d366-45f1-a754-aa921ce911b6&quot;,&quot;ec7a833e-9f5b-4817-a6a1-d49b4c5894f3&quot;,&quot;b978d824-4ee0-41aa-9c53-e41edf73cc22&quot;,&quot;810fc0fb-5186-4a45-9e9d-7a1fbd114b10&quot;,&quot;aaee6af0-abf7-412d-aad5-e4781655ce40&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:79,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;cc02de5e-e21a-4d5f-8edd-ac3be0f08559&quot;,&quot;title&quot;:&quot;Owner functions&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow not admin player to go to OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Owner functions should not allow not admin player to go to OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(deployedChallengeFixtureBase);\nawait expect(\n   challenge.connect(signers[1]).startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;OwnableUnauthorizedAccount\&quot;).withArgs(signers[1].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;98031035-8599-497d-8b69-4ad56c03b0b2&quot;,&quot;parentUUID&quot;:&quot;cc02de5e-e21a-4d5f-8edd-ac3be0f08559&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;98031035-8599-497d-8b69-4ad56c03b0b2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:3,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;0b28c441-15ff-4b01-a65b-ed871db48c83&quot;,&quot;title&quot;:&quot;State functions availability&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;159adcd8-ad6d-44ff-8839-83cbb00f953b&quot;,&quot;title&quot;:&quot;state GatheringPlayers&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers \&quot;before each\&quot; hook in \&quot;state GatheringPlayers\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers} = await loadFixture(deployedChallengeFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7fde5a65-eb47-498d-afac-2fda787b7f00&quot;,&quot;parentUUID&quot;:&quot;159adcd8-ad6d-44ff-8839-83cbb00f953b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow voteForWinner() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;3ab045a7-2615-4c91-8730-34624993021b&quot;,&quot;parentUUID&quot;:&quot;159adcd8-ad6d-44ff-8839-83cbb00f953b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow endWinnerVote() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;77ff1996-33d4-417a-bf1b-58a90ef933a6&quot;,&quot;parentUUID&quot;:&quot;159adcd8-ad6d-44ff-8839-83cbb00f953b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in GatheringPlayers state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state GatheringPlayers should not allow withdrawPrize() in GatheringPlayers state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;de60d16f-96d3-4523-a1c1-12b9cafe0604&quot;,&quot;parentUUID&quot;:&quot;159adcd8-ad6d-44ff-8839-83cbb00f953b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;3ab045a7-2615-4c91-8730-34624993021b&quot;,&quot;77ff1996-33d4-417a-bf1b-58a90ef933a6&quot;,&quot;de60d16f-96d3-4523-a1c1-12b9cafe0604&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:5,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;title&quot;:&quot;state OngoingChallenge&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge \&quot;before each\&quot; hook in \&quot;state OngoingChallenge\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(OngoingChallengeFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;779a34b9-6d3a-4884-8d11-71414517849c&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow joinChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;c34c08eb-3d0f-4fc1-844a-05c293066aed&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7dc86557-5735-4d36-a191-fa95c5fbbe47&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow startChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;22ee9981-b728-4795-905c-ce2040b79034&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow voteForWinner() in OngoingChallenge state (if the challenge is not over)&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;VotingNotAllowed\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;46d7ab3e-aac0-404c-a716-4e031952b934&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should allow voteForWinner() in OngoingChallenge state (if the challenge is over). state should become \&quot;VotingForWinner\&quot; after first player votes at the end of the challenge. &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;expect(await challenge.currentStatus()).to.equal(ChallengeStatus.OngoingChallenge);\n//wait for challenge to end\nawait time.increase(duration);\n\n//should be allowed\nawait expect(\n    challenge.voteForWinner(signers[1].address)\n).to.not.be.reverted;\n//State should have changed\nexpect(await challenge.currentStatus()).to.equal(ChallengeStatus.VotingForWinner);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;59f73464-e787-4d95-adc8-e2431b40af92&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow endWinnerVote() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;f1ef4fe0-7bb0-4ce5-bda9-b82d40f861c7&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in OnGoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state OngoingChallenge should not allow withdrawPrize() in OnGoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;72680fca-dbc2-4cdb-92c9-260e0149e0c9&quot;,&quot;parentUUID&quot;:&quot;6c0f26e1-a66d-46d3-b1e7-5cac20cb65ae&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;c34c08eb-3d0f-4fc1-844a-05c293066aed&quot;,&quot;7dc86557-5735-4d36-a191-fa95c5fbbe47&quot;,&quot;22ee9981-b728-4795-905c-ce2040b79034&quot;,&quot;46d7ab3e-aac0-404c-a716-4e031952b934&quot;,&quot;59f73464-e787-4d95-adc8-e2431b40af92&quot;,&quot;f1ef4fe0-7bb0-4ce5-bda9-b82d40f861c7&quot;,&quot;72680fca-dbc2-4cdb-92c9-260e0149e0c9&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:15,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;title&quot;:&quot;state VotingForWinner&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner \&quot;before each\&quot; hook in \&quot;state VotingForWinner\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(VotingForWinnerFixture));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b488cc2f-74b4-4bf8-b67d-a3e111a43b96&quot;,&quot;parentUUID&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow joinChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;281e8404-6258-49c0-a316-c270d2c80706&quot;,&quot;parentUUID&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;188a7873-ddf8-47bd-a031-2c2ca2670817&quot;,&quot;parentUUID&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow startChallenge() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fa28bd26-faf2-483b-9b50-3b3efda5868d&quot;,&quot;parentUUID&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawPrize() in VotingForWinner state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state VotingForWinner should not allow withdrawPrize() in VotingForWinner state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawPrize()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2b68e740-5143-4841-b354-da5bf9ce5573&quot;,&quot;parentUUID&quot;:&quot;5f52bd66-5412-4763-b789-268a9d13a832&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;281e8404-6258-49c0-a316-c270d2c80706&quot;,&quot;188a7873-ddf8-47bd-a031-2c2ca2670817&quot;,&quot;fa28bd26-faf2-483b-9b50-3b3efda5868d&quot;,&quot;2b68e740-5143-4841-b354-da5bf9ce5573&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:6,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;title&quot;:&quot;state ChallengeWon&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon \&quot;before each\&quot; hook in \&quot;state ChallengeWon\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challenge, signers, bid, token} = await loadFixture(EndingVoteFixture));\nawait challenge.endWinnerVote();&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e84c2334-ebf1-44fb-bd97-68788f197f40&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should not allow joinChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow joinChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(\n    challenge.joinChallenge(deadline1, v1, r1, s1, [])\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;7d902a9c-c8bf-43b7-9028-746b8f99e1ac&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow withdrawFromChallenge() in OngoingChallenge state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.withdrawFromChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;407843c8-ea16-4b2d-a774-606747e73f47&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow startChallenge() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow startChallenge() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.startChallenge()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;797426f3-e3e5-4b93-a6ab-4c6a92aade4c&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow voteForWinner() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow voteForWinner() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.voteForWinner(signers[1].address)\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e792dd3a-20a5-4fff-9603-87752d421338&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract State functions availability state ChallengeWon should not allow endWinnerVote() in ChallengeWon state&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challenge.endWinnerVote()\n).to.be.revertedWithCustomError(challenge, \&quot;InvalidState\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0447bf08-97e9-4ab9-83f5-6c4c566860c1&quot;,&quot;parentUUID&quot;:&quot;0b39704e-f6a1-4873-8b21-91bf7af2d22d&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;7d902a9c-c8bf-43b7-9028-746b8f99e1ac&quot;,&quot;407843c8-ea16-4b2d-a774-606747e73f47&quot;,&quot;797426f3-e3e5-4b93-a6ab-4c6a92aade4c&quot;,&quot;e792dd3a-20a5-4fff-9603-87752d421338&quot;,&quot;0447bf08-97e9-4ab9-83f5-6c4c566860c1&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:10,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;title&quot;:&quot;Events&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/Challenge.test.js&quot;,&quot;file&quot;:&quot;/test/Challenge.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should emit an event when a Player Joined&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Joined&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait expect(challenge.joinChallenge(deadline1, v1, r1, s1, []))\n    .to.emit(challenge, \&quot;PlayerJoined\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;84ae717b-f12c-4d99-bd49-5dcadf01c5e7&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a Player Withdraws from challenge&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a Player Withdraws from challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:7,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait expect(challenge.withdrawFromChallenge())\n    .to.emit(challenge, \&quot;PlayerWithdrawn\&quot;)\n    .withArgs(signers[0].address);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0073c881-4f71-40cb-a02b-d81d44b10ef7&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeStarted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeStarted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:11,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid, token} = await loadFixture(deployedChallengeFixtureBase)\nconst { v: v1, r: r1, s: s1, deadline: deadline1 } = await GetRSVsig(signers[0], token, bid, challenge);\nconst { v: v2, r: r2, s: s2, deadline: deadline2 } = await GetRSVsig(signers[1], token, bid, challenge);\nawait challenge.joinChallenge(deadline1, v1, r1, s1, []);\nawait challenge.connect(signers[1]).joinChallenge(deadline2, v2, r2, s2, []);\nawait expect(challenge.startChallenge())\n    .to.emit(challenge, \&quot;ChallengeStarted\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;daf2a10b-a20f-4979-a88d-dce8b94ee703&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when ChallengeEnded &quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when ChallengeEnded &quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:50,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(OngoingChallengeFixture)\n//Pass enough time\nawait time.increase(duration)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;ChallengeEnded\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;d077adfd-6b7c-43da-a412-26068fb5ef3e&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when PlayerVoted&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when PlayerVoted&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:45,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers} = await loadFixture(VotingForWinnerFixture)\nawait expect(challenge.voteForWinner(signers[1].address))\n    .to.emit(challenge, \&quot;PlayerVoted\&quot;)\n    .withArgs(signers[0].address, signers[1].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6bd67f89-9848-4705-9fda-a2c806da2ad3&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event when a prize is sent&quot;,&quot;fullTitle&quot;:&quot;tests Challenge contract Events should emit an event when a prize is sent&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:55,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;medium&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const {challenge, signers, bid} = await loadFixture(EndingVoteFixture)\nawait challenge.endWinnerVote()\nconst expectedPrize = bid*5n - 5n*bid*BigInt(gold)/100n;\nawait expect(\n    await challenge.connect(signers[1]).withdrawPrize()\n).to.emit(challenge, \&quot;PrizeWithdrawn\&quot;)\n    .withArgs(signers[1].address, expectedPrize)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;dba47a5e-a953-4f75-a073-e31e1df7ec2d&quot;,&quot;parentUUID&quot;:&quot;dfbf33a9-fbac-4dbb-a0dc-b35a300f9a1e&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;84ae717b-f12c-4d99-bd49-5dcadf01c5e7&quot;,&quot;0073c881-4f71-40cb-a02b-d81d44b10ef7&quot;,&quot;daf2a10b-a20f-4979-a88d-dce8b94ee703&quot;,&quot;d077adfd-6b7c-43da-a412-26068fb5ef3e&quot;,&quot;6bd67f89-9848-4705-9fda-a2c806da2ad3&quot;,&quot;dba47a5e-a953-4f75-a073-e31e1df7ec2d&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:174,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;26597e94-b20c-40b9-9928-e447f4a0a4b7&quot;,&quot;title&quot;:&quot;tests ChallengeFactory contract&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[],&quot;afterHooks&quot;:[],&quot;tests&quot;:[],&quot;suites&quot;:[{&quot;uuid&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;title&quot;:&quot;First tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;First tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests \&quot;before each\&quot; hook in \&quot;First tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));\nawait challengeFactory.createChallenge(duration, maxPlayers, bid, description, 0, ethers.ZeroHash, \&quot;ipfsCid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4b306e18-49d3-4b33-a4df-0803992639f0&quot;,&quot;parentUUID&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should just deploy the challenge factory, and create a challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should just deploy the challenge factory, and create a challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;91a7cb49-65b8-4973-a88a-95aad69bfb6f&quot;,&quot;parentUUID&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should emit an event on new challenge deployment&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should emit an event on new challenge deployment&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:3,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const filter = challengeFactory.filters.ChallengeCreated(signers[0].address);\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            expect(event.fragment.name).to.equal(&#x27;ChallengeCreated&#x27;)\n            const args = event.args\n            expect(args.admin).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;0f258fca-c786-438e-9a49-f8f68d0ab662&quot;,&quot;parentUUID&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should allow to deploy a new challenge contract&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should allow to deploy a new challenge contract&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n            const filter = challengeFactory.filters.ChallengeCreated;\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            const newContractAddress = event.args.challengeAddress;\n            // 3. Attach to the deployed challenge\n            const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n            const challenge = Challenge.attach(newContractAddress);\n            // Verify initialisation\n            const _duration = await challenge.duration();\n            const _maxPlayers = await challenge.maxPlayers();\n            const _bid = await challenge.bid();\n            const _description = await challenge.description();\n            expect(_duration).to.equal(1000n);\n            expect(_maxPlayers).to.equal(5n);\n            expect(_bid).to.equal(bid);\n            expect(_description).to.equal(\&quot;test\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;28b29f62-09c3-4f48-bbdd-cdff226bea4b&quot;,&quot;parentUUID&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract First tests should set the caller of the function createChallenge as owner of the challenge&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:5,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;// 2. Extract the address from the event\n            const filter = challengeFactory.filters.ChallengeCreated;\n            const events = await challengeFactory.queryFilter(filter, -1)\n            const event = events[0]\n            const newContractAddress = event.args.challengeAddress;\n            // 3. Attach to the deployed challenge\n            const Challenge = await ethers.getContractFactory(\&quot;Challenge\&quot;);\n            const challenge = Challenge.attach(newContractAddress);\n            const owner = await challenge.owner()\n            expect(owner).to.equal(signers[0].address)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;b7afea67-5115-40dd-b764-e09e5712b12f&quot;,&quot;parentUUID&quot;:&quot;d555c261-bce9-4673-a017-f2ec80a508b3&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;91a7cb49-65b8-4973-a88a-95aad69bfb6f&quot;,&quot;0f258fca-c786-438e-9a49-f8f68d0ab662&quot;,&quot;28b29f62-09c3-4f48-bbdd-cdff226bea4b&quot;,&quot;b7afea67-5115-40dd-b764-e09e5712b12f&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:14,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;title&quot;:&quot;Parameter Validation Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Parameter Validation Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests \&quot;before each\&quot; hook in \&quot;Parameter Validation Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;cd48bef1-6c08-43c0-bf89-3d44a579f902&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should revert with ZeroAddressToken when token address is zero&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with ZeroAddressToken when token address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:4,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(\&quot;0x0000000000000000000000000000000000000000\&quot;, signers[0].address)\n).to.be.revertedWithCustomError(ChallengeFactory, \&quot;ZeroAddressToken\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;e12f5d30-81b4-4d71-8195-1db71c37c2fc&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with ZeroAddressFeeReceiver when feeReceiver address is zero&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with ZeroAddressFeeReceiver when feeReceiver address is zero&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:6,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;const ChallengeFactory = await ethers.getContractFactory(&#x27;ChallengeFactory&#x27;);\nawait expect(\n    ChallengeFactory.deploy(token.target, \&quot;0x0000000000000000000000000000000000000000\&quot;)\n).to.be.revertedWithCustomError( ChallengeFactory, \&quot;ZeroAddressFeeReceiver\&quot;)&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;fbec2442-6373-40d7-a4c8-adaa81bd5c9c&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InvalidDuration when duration is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InvalidDuration when duration is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        0n, // Invalid duration\n        maxPlayers,\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InvalidDuration\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;169f069c-c43f-4a94-aa69-5e38e09355e8&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers is less than 2&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientPlayers when maxPlayers is less than 2&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        1n, // Invalid: less than 2\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;859be7df-9e59-4ac7-9575-4956216c1012&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientPlayers when maxPlayers is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientPlayers when maxPlayers is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        0n, // Invalid: 0 players\n        bid,\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientPlayers\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;4f08a7e2-7a38-4f4d-adce-af2905a06be2&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false},{&quot;title&quot;:&quot;should revert with InsufficientBid when bid is 0&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Parameter Validation Tests should revert with InsufficientBid when bid is 0&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:1,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        maxPlayers,\n        0n, // Invalid bid\n        description,\n        false,\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.be.revertedWithCustomError(challengeFactory, \&quot;InsufficientBid\&quot;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;6e3c7cb9-0644-407d-9569-883d55e6e6d6&quot;,&quot;parentUUID&quot;:&quot;f20aa50c-6c4d-4955-8623-eec69354118b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;e12f5d30-81b4-4d71-8195-1db71c37c2fc&quot;,&quot;fbec2442-6373-40d7-a4c8-adaa81bd5c9c&quot;,&quot;169f069c-c43f-4a94-aa69-5e38e09355e8&quot;,&quot;859be7df-9e59-4ac7-9575-4956216c1012&quot;,&quot;4f08a7e2-7a38-4f4d-adce-af2905a06be2&quot;,&quot;6e3c7cb9-0644-407d-9569-883d55e6e6d6&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:16,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000},{&quot;uuid&quot;:&quot;305dc608-3a1a-485b-98a1-f42ed969b05b&quot;,&quot;title&quot;:&quot;Group Mode Tests&quot;,&quot;fullFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test/ChallengeFactory.test.js&quot;,&quot;file&quot;:&quot;/test/ChallengeFactory.test.js&quot;,&quot;beforeHooks&quot;:[{&quot;title&quot;:&quot;\&quot;before each\&quot; hook in \&quot;Group Mode Tests\&quot;&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Group Mode Tests \&quot;before each\&quot; hook in \&quot;Group Mode Tests\&quot;&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:0,&quot;pass&quot;:false,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;({challengeFactory, signers, token } = await loadFixture(deployedChallengeFactoryFixtureBase));&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;a03d73e4-2904-4ca7-9f54-e7c0f3fc48cf&quot;,&quot;parentUUID&quot;:&quot;305dc608-3a1a-485b-98a1-f42ed969b05b&quot;,&quot;isHook&quot;:true,&quot;skipped&quot;:false}],&quot;afterHooks&quot;:[],&quot;tests&quot;:[{&quot;title&quot;:&quot;should create challenge with groupMode false and zero merkle root&quot;,&quot;fullTitle&quot;:&quot;tests ChallengeFactory contract Group Mode Tests should create challenge with groupMode false and zero merkle root&quot;,&quot;timedOut&quot;:false,&quot;duration&quot;:2,&quot;state&quot;:&quot;passed&quot;,&quot;speed&quot;:&quot;fast&quot;,&quot;pass&quot;:true,&quot;fail&quot;:false,&quot;pending&quot;:false,&quot;code&quot;:&quot;await expect(\n    challengeFactory.createChallenge(\n        duration,\n        maxPlayers,\n        bid,\n        description,\n        false, // groupMode = false\n        ethers.ZeroHash,\n        \&quot;ipfsCid\&quot;\n    )\n).to.emit(challengeFactory, &#x27;ChallengeCreated&#x27;);&quot;,&quot;err&quot;:{},&quot;uuid&quot;:&quot;2a175c04-8843-40ed-861b-3fa4ef0149c2&quot;,&quot;parentUUID&quot;:&quot;305dc608-3a1a-485b-98a1-f42ed969b05b&quot;,&quot;isHook&quot;:false,&quot;skipped&quot;:false}],&quot;suites&quot;:[],&quot;passes&quot;:[&quot;2a175c04-8843-40ed-861b-3fa4ef0149c2&quot;],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:2,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:false,&quot;rootEmpty&quot;:false,&quot;_timeout&quot;:40000}],&quot;passes&quot;:[],&quot;failures&quot;:[],&quot;pending&quot;:[],&quot;skipped&quot;:[],&quot;duration&quot;:0,&quot;root&quot;:true,&quot;rootEmpty&quot;:true,&quot;_timeout&quot;:40000}],&quot;meta&quot;:{&quot;mocha&quot;:{&quot;version&quot;:&quot;10.8.2&quot;},&quot;mochawesome&quot;:{&quot;options&quot;:{&quot;quiet&quot;:true,&quot;reportFilename&quot;:&quot;report&quot;,&quot;saveHtml&quot;:true,&quot;saveJson&quot;:true,&quot;consoleReporter&quot;:&quot;spec&quot;,&quot;useInlineDiffs&quot;:false,&quot;code&quot;:true},&quot;version&quot;:&quot;7.1.3&quot;},&quot;marge&quot;:{&quot;options&quot;:{&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportFilename&quot;:&quot;report&quot;,&quot;quiet&quot;:true},&quot;version&quot;:&quot;6.2.0&quot;}}}" data-config="{&quot;reportFilename&quot;:&quot;report&quot;,&quot;reportDir&quot;:&quot;test-report&quot;,&quot;reportTitle&quot;:&quot;backend&quot;,&quot;reportPageTitle&quot;:&quot;Mochawesome Report&quot;,&quot;inline&quot;:false,&quot;inlineAssets&quot;:false,&quot;cdn&quot;:false,&quot;charts&quot;:false,&quot;enableCharts&quot;:false,&quot;code&quot;:true,&quot;enableCode&quot;:true,&quot;autoOpen&quot;:false,&quot;overwrite&quot;:true,&quot;timestamp&quot;:false,&quot;ts&quot;:false,&quot;showPassed&quot;:true,&quot;showFailed&quot;:true,&quot;showPending&quot;:true,&quot;showSkipped&quot;:false,&quot;showHooks&quot;:&quot;failed&quot;,&quot;saveJson&quot;:true,&quot;saveHtml&quot;:true,&quot;dev&quot;:false,&quot;assetsDir&quot;:&quot;test-report/assets&quot;,&quot;jsonFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.json&quot;,&quot;htmlFile&quot;:&quot;/home/ibuntu/BlockchainDev/Alyra/MyTests/PROJET_FINAL/backend/test-report/report.html&quot;}"><div id="report"></div><script src="assets/app.js"></script></body></html>